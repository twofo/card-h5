(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-mineModule-pages-selectDepartmentOrBuild-selectDepartmentOrBuild"],{1789:function(e,t,a){var c=a("24fb");t=c(!1),t.push([e.i,'.right-box[data-v-5529ba17]{width:%?150?%;height:100%;border-left:1px #e3e3e3 solid;color:#2eaaf8}.right-img[data-v-5529ba17]{width:16px;height:16px;margin-right:%?15?%;margin-top:%?10?%}.center-top[data-v-5529ba17]{margin-top:%?10?%;padding-top:%?30?%}.box[data-v-5529ba17]{width:75%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.floor-box[data-v-5529ba17]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}uni-button[type="primary"][data-v-5529ba17]{background-color:#20a4f7}.searchBox[data-v-5529ba17]{padding:0 %?20?%;box-sizing:border-box;background:#fff}',""]),e.exports=t},"5e06":function(e,t,a){var c=a("1789");"string"===typeof c&&(c=[[e.i,c,""]]),c.locals&&(e.exports=c.locals);var i=a("4f06").default;i("13ae085e",c,!0,{sourceMap:!1,shadowMode:!1})},"6b2c":function(e,t,a){"use strict";var c=a("4ea4");a("13d5"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=c(a("fa13")),s=getApp(),o=a("9be7"),l={data:function(){return{mineImageUrl:o,checkboxItems:[],checkAll:{name:"全选",value:"00",checked:!1},limitSelectPerson:"",disabled:!1,recevie:[],t:0,selectId:0,attendeeCach:"",hosterCach:"",recoderCach:"",receiveCach:""}},components:{searchInp:i.default},onLoad:function(e){console.log("选择接收人     "),console.log(e);var t=this.disabled.disabled;if(1==e.selectId&&(this.selectByParentId(0),this.getStorageData()),2==e.selectId&&this.selectByBuildId(0),this.setData({selectId:e.selectId}),e.limitSelectPerson){var a=e.limitSelectPerson;t="hoster"==a||"recoder"==a,this.setData({limitSelectPerson:a,disabled:t})}},methods:{getStorageData:function(){var e=this.checkboxItems,t=[];"attendee"==this.limitSelectPerson?t=s.globalData.StorageUtil.get("attendeeCach"):"hoster"==this.limitSelectPerson?t=s.globalData.StorageUtil.get("hosterCach"):"recoder"==this.limitSelectPerson&&(t=s.globalData.StorageUtil.get("recoderCach"));for(var a=0;a<e.length;a++)for(var c=0;c<t.length;c++)e[a].id==t[c].id&&e[a].type==t[c].type&&e[a].name==t[c].name&&(e[a]=t[c],console.log(e[a]));this.setData({checkboxItems:e})},selectByParentId:function(e){s.globalData.ShowMsgUtil.netErrNotice();for(var t=this,a=s.globalData.StorageUtil.get("userInfoCach"),c=s.globalData.StorageUtil.get("receiveCach"),i=this.recevie,o=this.t,l=0;l<this.checkboxItems.length;++l){if(this.checkboxItems[l].checked&&(this.checkboxItems[l].isTeacher=1,i[o]=this.checkboxItems[l],o++),this.checkboxItems[l].id==e&&this.checkboxItems[l].checked)return}wx.request({url:s.globalData.RequestUrl.baseRequestUrl.byOrg+"?parentId="+e,method:"GET",header:{token:a.token},success:function(e){if(console.log("根据部门父级查询返回",e.data),e.data&&200==e.data.code){for(var a=[],i=0,o=0;o<e.data.rows.length;++o){var l={};l.id=e.data.rows[o].orgId,l.name=e.data.rows[o].name,l.parent=e.data.rows[o].parent,l.parentId=e.data.rows[o].parentId,l.isHasChild=e.data.rows[o].isHasChild,l.code=e.data.rows[o].code,l.type=e.data.rows[o].type,l.value=o,null==t.limitSelectPerson&&c&&c.length>i&&e.data.rows[o].orgId==c[i].id&&(l.checked=!!c[i].id,i++),a[o]=l}t.setData({checkboxItems:a}),t.getStorageData()}else s.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){s.globalData.ShowMsgUtil.showNoneToastByFail()}}),this.setData({recevie:i,t:o})},selectByBuildId:function(e){s.globalData.ShowMsgUtil.netErrNotice();var t=s.globalData.StorageUtil.get("userInfoCach"),a=s.globalData.StorageUtil.get("receiveCach"),c=this;wx.request({url:s.globalData.RequestUrl.baseRequestUrl.byBuilding+"?parentId="+e,method:"GET",header:{token:t.token},success:function(e){if(e.data&&200==e.data.code){var t=[],i=0;console.log("根据楼栋父级查询返回",e.data);for(var o=0;o<e.data.rows.length;++o){var l={};l.id=e.data.rows[o].orgId,l.name=e.data.rows[o].name,l.parent=e.data.rows[o].parent,l.isHasChild=e.data.rows[o].isHasChild,l.code=e.data.rows[o].code,l.type=e.data.rows[o].type,l.value=o,a&&a.length>i&&e.data.rows[o].orgId==a[i].id&&(l.checked=!!a[i].id,i++),t[o]=l}c.setData({checkboxItems:t})}else s.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){s.globalData.ShowMsgUtil.showNoneToastByFail()}})},checkboxChange:function(e){var t=this.disabled,a=this.limitSelectPerson,c=this.checkboxItems,i=e.currentTarget.dataset.value;console.log("选中的成员");for(var s=0,o=c.length;s<o;++s)if(c[s].value==i){c[s].checked=!c[s].checked,("hoster"==a||"recoder"==a)&&(t=t=1==c[s].isHasChild);break}console.log(c),this.setData({checkboxItems:c,disabled:t})},checkAllFun:function(e){var t=this,a=t.checkboxItems,c=!t.checkAll.checked;if(c)for(var i=0,s=a.length;i<s;++i)a[i].checked=!0;else for(i=0,s=a.length;i<s;++i)a[i].checked=!1;this.setData({checkboxItems:a,"checkAll.checked":c})},gainByParent:function(e){this.selectByParentId(e.currentTarget.dataset.id)},confirmReceive:function(){var e=this,t=e.checkboxItems,a=[],c=0;this.setData({disabled:!0});for(var i=0;i<t.length;++i){t[i].checked&&(t[i].isTeacher=1,a[c]=t[i],c++)}if(0==a.length&&s.globalData.ShowMsgUtil.showErrorModal("公告发送失败","请选择接收人"),console.log(a),"attendee"==this.limitSelectPerson){if(this.recevie!={})for(var o=0;o<this.recevie.length;++o)a.push(this.recevie[o]);var l=this.reduce(a);s.globalData.StorageUtil.set("attendeeCach",l);var r=getCurrentPages(),n=r[r.length-3];n.setData({attendeeCach:a})}else if("hoster"==this.limitSelectPerson){var h=s.globalData.StorageUtil.get("hosterCach");if(a.length>=2||h.length>=2)return s.globalData.ShowMsgUtil.showNoneToast("选择人数不能超过一个",3e3),void this.setData({disabled:!1});var d=this.reduce(a);s.globalData.StorageUtil.set("hosterCach",d);var u=getCurrentPages(),g=u[u.length-3];g.setData({hosterCach:a})}else if("recoder"==this.limitSelectPerson){var v=s.globalData.StorageUtil.get("recoderCach");if(a.length>=2||v.length>=2)return s.globalData.ShowMsgUtil.showNoneToast("选择人数不能超过一个",3e3),void this.setData({disabled:!1});var b=this.reduce(a);s.globalData.StorageUtil.set("recoderCach",b);var f=getCurrentPages(),w=f[f.length-3];w.setData({recoderCach:a})}else{var p=this.reduce(a);s.globalData.StorageUtil.set("receiveCach",p);var k=getCurrentPages(),m=k[k.length-3];m.setData({receiveCach:a})}wx.navigateBack({delta:2})},reduce:function(e){for(var t=[],a=0;a<e.length;a++){for(var c=a+1;c<e.length;c++)e[a]===e[c]&&++a;t.push(e[a])}return t},seachSch:function(e){console.log(e);var t=e.detail.value;console.log(t),s.globalData.ShowMsgUtil.netErrNotice();var a=this,c=s.globalData.StorageUtil.get("userInfoCach"),i=s.globalData.RequestUrl.appointmentRequestUrl.searchPersonnel+"?personType=1&userName="+t;wx.request({url:i,method:"GET",header:{token:c.token},success:function(e){if(console.log("搜素选择人员",e.data),e.data&&200==e.data.code){for(var t=[],c=0;c<e.data.rows.length;++c){var i={};i.id=e.data.rows[c].userId,i.name=e.data.rows[c].userName,i.type=e.data.rows[c].userType,i.value=c,t[c]=i}a.setData({checkboxItems:t})}else s.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){s.globalData.ShowMsgUtil.showNoneToastByFail()}})},mysearchValLen:function(e){console.log(e);var t=e.detail.valLength;0==t&&(1==this.selectId&&this.selectByParentId(0),2==this.selectId&&this.selectByBuildId(0))},isCode:function(e){var t=/^\+?[1-9][0-9]*$/;return!!t.test(e)}}};t.default=l},"8e35":function(e,t,a){"use strict";a.r(t);var c=a("ecda"),i=a("b9fc");for(var s in i)"default"!==s&&function(e){a.d(t,e,(function(){return i[e]}))}(s);a("ee25");var o,l=a("f0c5"),r=Object(l["a"])(i["default"],c["b"],c["c"],!1,null,"5529ba17",null,!1,c["a"],o);t["default"]=r.exports},"9be7":function(e,t){var a="/static/pages/mineModule/resources/pic",c={image:a,enter:"".concat(a,"/enter.png"),lanshan:"".concat(a,"/lanshan.png"),logo:"".concat(a,"/logo.png"),camera:"".concat(a,"/camera.png"),branch:"".concat(a,"/branch.png"),faceImg:"".concat(a,"/faceImg.png"),xcImg:"".concat(a,"/xcImg.png"),compareImg:"".concat(a,"/compare.png"),bgColorImg:"".concat(a,"/bgColor.png")};e.exports=c},b9fc:function(e,t,a){"use strict";a.r(t);var c=a("6b2c"),i=a.n(c);for(var s in c)"default"!==s&&function(e){a.d(t,e,(function(){return c[e]}))}(s);t["default"]=i.a},ecda:function(e,t,a){"use strict";var c;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return c}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"page"},[a("v-uni-view",{staticClass:"page__bd"},[a("v-uni-view",{staticClass:"searchBox"},[a("search-inp",{attrs:{placeholder:"请输入名字"},on:{searchInp:function(t){arguments[0]=t=e.$handleEvent(t),e.seachSch.apply(void 0,arguments)},mysearchValLen:function(t){arguments[0]=t=e.$handleEvent(t),e.mysearchValLen.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"weui-cells weui-cells_after-title top"},[a("v-uni-label",{staticClass:"weui-cell weui-check__label",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.checkAllFun.apply(void 0,arguments)}}},[a("v-uni-checkbox",{staticClass:"weui-check",attrs:{value:e.checkAll.value,checked:e.checkAll.checked}}),a("v-uni-view",{staticClass:"weui-cell__hd weui-check__hd_in-checkbox"},[e.checkAll.checked?e._e():a("v-uni-icon",{staticClass:"weui-icon-checkbox_circle",attrs:{type:"circle",size:"23"}}),e.checkAll.checked?a("v-uni-icon",{staticClass:"weui-icon-checkbox_success",attrs:{type:"success",size:"23"}}):e._e()],1),a("v-uni-view",{staticClass:"weui-cell__bd"},[e._v(e._s(e.checkAll.name))])],1)],1),a("v-uni-view",{staticClass:"weui-cells weui-cells_after-title center-top"},[a("v-uni-scroll-view",{staticStyle:{height:"400px"},attrs:{"scroll-y":!0,"scroll-into-view":e.toView,"scroll-top":e.scrollTop}},[0!=e.checkboxItems.length?a("v-uni-view",e._l(e.checkboxItems,(function(t,c){return a("v-uni-label",{key:c,staticClass:"weui-cell weui-check__label",attrs:{item:t}},[a("v-uni-view",{staticClass:"box",attrs:{"data-value":t.value},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.checkboxChange.apply(void 0,arguments)}}},[a("v-uni-checkbox",{staticClass:"weui-check",attrs:{value:t.value,checked:t.checked}}),a("v-uni-view",{staticClass:"weui-cell__hd weui-check__hd_in-checkbox"},[t.checked?e._e():a("v-uni-icon",{staticClass:"weui-icon-checkbox_circle",attrs:{type:"circle",size:"23"}}),t.checked?a("v-uni-icon",{staticClass:"weui-icon-checkbox_success",attrs:{type:"success",size:"23"}}):e._e()],1),a("v-uni-view",{staticClass:"weui-cell__bd",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.checkboxChange.apply(void 0,arguments)}}},[e._v(e._s(t.name))])],1),a("v-uni-view",{staticClass:"weui-cell__ft right-box",attrs:{"data-id":t.id},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.gainByParent.apply(void 0,arguments)}}},[1==t.isHasChild?a("v-uni-view",[a("v-uni-image",{staticClass:"right-img",attrs:{src:e.mineImageUrl.branch}}),e._v("下级")],1):e._e()],1)],1)})),1):e._e(),0==e.checkboxItems.length?a("v-uni-view",[a("v-uni-view",{staticClass:"floor-box"},[a("v-uni-text",[e._v("暂无成员"+e._s(e.checkboxItems.length))])],1)],1):e._e()],1)],1),a("v-uni-view",{staticClass:"weui-btn-area"},[a("v-uni-button",{staticClass:"weui-btn",attrs:{type:"primary",disabled:e.disabled},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.confirmReceive.apply(void 0,arguments)}}},[e._v("确定")])],1)],1)],1)},s=[]},ee25:function(e,t,a){"use strict";var c=a("5e06"),i=a.n(c);i.a}}]);