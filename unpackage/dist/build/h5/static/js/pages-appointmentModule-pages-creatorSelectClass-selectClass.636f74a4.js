(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-appointmentModule-pages-creatorSelectClass-selectClass"],{"0047":function(e,t,a){"use strict";a.r(t);var o=a("efee"),l=a.n(o);for(var s in o)"default"!==s&&function(e){a.d(t,e,(function(){return o[e]}))}(s);t["default"]=l.a},"06c5":function(e,t,a){"use strict";a("a630"),a("fb6a"),a("d3b7"),a("25f0"),a("3ca3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=l(a("6b75"));function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(e){if("string"===typeof e)return(0,o.default)(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?(0,o.default)(e,t):void 0}}},"0e14":function(e,t,a){"use strict";a.r(t);var o=a("b2a1"),l=a("0047");for(var s in l)"default"!==s&&function(e){a.d(t,e,(function(){return l[e]}))}(s);a("8fc3");var n,r=a("f0c5"),c=Object(r["a"])(l["default"],o["b"],o["c"],!1,null,"7aaaaaca",null,!1,o["a"],n);t["default"]=c.exports},2909:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var o=r(a("6005")),l=r(a("db90")),s=r(a("06c5")),n=r(a("3427"));function r(e){return e&&e.__esModule?e:{default:e}}function c(e){return(0,o.default)(e)||(0,l.default)(e)||(0,s.default)(e)||(0,n.default)()}},3427:function(e,t,a){"use strict";function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o},4834:function(e,t,a){var o=a("7bf8");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var l=a("4f06").default;l("0612961d",o,!0,{sourceMap:!1,shadowMode:!1})},6005:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=l(a("6b75"));function l(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e))return(0,o.default)(e)}},"6b75":function(e,t,a){"use strict";function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o},"7bf8":function(e,t,a){var o=a("24fb");t=o(!1),t.push([e.i,".searchBox[data-v-7aaaaaca]{padding:0 %?20?%;box-sizing:border-box}",""]),e.exports=t},"8fc3":function(e,t,a){"use strict";var o=a("4834"),l=a.n(o);l.a},b2a1:function(e,t,a){"use strict";var o;a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o}));var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"page"},[a("v-uni-view",{staticClass:"searchBox"},[a("search-inp",{attrs:{placeholder:e.placeholder},on:{searchInp:function(t){arguments[0]=t=e.$handleEvent(t),e.seachSch.apply(void 0,arguments)},mysearchValLen:function(t){arguments[0]=t=e.$handleEvent(t),e.mysearchValLen.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"page__bd"},[a("select-recevice",{attrs:{disableds:e.disableds,loadNotice:e.loadNotice,sHeight:e.sHeight,stidentCount:e.stidentCount,checkboxItems:e.checkboxItems,checkAll:e.checkAll},on:{myevent:function(t){arguments[0]=t=e.$handleEvent(t),e.onMyEvent.apply(void 0,arguments)},singleChecked:function(t){arguments[0]=t=e.$handleEvent(t),e.singleChecked.apply(void 0,arguments)},lower:function(t){arguments[0]=t=e.$handleEvent(t),e.lower.apply(void 0,arguments)}}})],1)],1)},s=[]},db90:function(e,t,a){"use strict";function o(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("d3b7"),a("3ca3"),a("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=o},efee:function(e,t,a){"use strict";var o=a("4ea4");a("99af"),a("a434"),a("b64b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=o(a("2909")),s=o(a("e8d7")),n=o(a("fa13")),r=getApp(),c={data:function(){return{checkboxItems:[],checkAll:{name:"全选",value:"00",checked:!1},limitSelectPerson:"",disableds:!1,placeholder:"请输入名称",parentId:"",selectType:1,stidentCount:!1,loadNotice:"",currentPage:0,totalPage:null,searchValInp:"",isHasLower:!0,sHeight:""}},components:{selectRecevice:s.default,searchInp:n.default},props:{},onLoad:function(e){if(console.log("------------------------选择班级------------------------"),console.log(e),this.setData({parentId:e.parentId}),e.limitSelectPerson){var t=e.limitSelectPerson;if("recoder"==t||"hoster"==t)var a="请输入教师或学生名字";else if("dutyTeacher"==t)a="请输入责任教师名字";else a="请输入部门/班级/教师/学生名称";var o=r.globalData.SystemInfo.screenHeight-390;this.setData({limitSelectPerson:t,placeholder:a,sHeight:o})}},methods:{showSecondData:function(){var e=this.limitSelectPerson,t=(this.checkboxItems,[]);return"attendee"==e&&(t=r.globalData.StorageUtil.get("attendeeStudentCach")),t},selectPersonnel:function(e,t,a){var o=this;r.globalData.ShowMsgUtil.netErrNotice();var l=r.globalData.StorageUtil.get("userInfoCach");wx.request({url:r.globalData.RequestUrl.appointmentRequestUrl.selectPersonnel+"?selectType="+t+"&parentId="+a,method:"GET",header:{token:l.token},success:function(t){if(console.log('人员选择（学生）"',t.data),t.data&&200==t.data.code){for(var a=0;a<t.data.rows.length;++a)t.data.rows[a].value=a,t.data.rows[a].enable=!0,console.log("haveCheckboxItem-",e),""!=e&&(t.data.rows[a]=o.dealSelectPerson(e,t.data.rows[a]));o.setData({checkboxItems:t.data.rows,selectType:t.data.rows[0].level})}else r.globalData.ShowMsgUtil.showErrorModal("请求失败",t.data.msg,t.data.code)},fail:function(){r.globalData.ShowMsgUtil.showNoneToastByFail()}})},dealSelectPerson:function(e,t){for(var a=0;a<e.length;++a)if(t.selectType==e[a].selectType&&t.selectId==e[a].id)return!0;return!1},singleChecked:function(e){console.log(e)},onMyEvent:function(e){console.log(e);var t=this.limitSelectPerson,a=e.detail.valueType,o=(e.detail.parentId,e.detail.checkboxItems),s=this.checkboxItems,n=r.globalData.StorageUtil.get("attendeeStudentCach"),c=r.globalData.StorageUtil.get("hosterCach"),i=r.globalData.StorageUtil.get("recoderCach"),d=[],u=[];if(console.log(o),o){if("attendee"==t){if(s.length===o.length)var h=o;else if(s.length>=1&&0==o.length)h=this.cancelChecked(n,s);else if(n.length>0){var f=this.cancelChecked(s,o),p=this.cancelChecked(n,f);h=[].concat((0,l.default)(p),(0,l.default)(o))}else h=o;d.push.apply(d,(0,l.default)(h).concat((0,l.default)(n)))}else if("hoster"==t){if(c.length>0||o.length>1)return void r.globalData.ShowMsgUtil.showNoneToast("选择人只能数不能超过一个",1500);if(o.length>=1&&4!=o[0].selectType)return void r.globalData.ShowMsgUtil.showNoneToast("选择人只能数不能超过一个",1500);d.push.apply(d,(0,l.default)(o).concat((0,l.default)(c)))}else if("recoder"==t){if(i.length>0||o.length>1)return void r.globalData.ShowMsgUtil.showNoneToast("选择人数不能超过一个",3e3);if(o.length>=1&&4!=o[0].selectType)return void r.globalData.ShowMsgUtil.showNoneToast("选择人只能数不能超过一个",1500);d.push.apply(d,(0,l.default)(o).concat((0,l.default)(i)))}u=this.reduceFun(d)}1==a||2==a&&(this.dataFun(u),"attendee"==t?r.globalData.StorageUtil.set("attendeeStudentCach",u):"hoster"==t?r.globalData.StorageUtil.set("hosterCach",u):"recoder"==t&&r.globalData.StorageUtil.set("recoderCach",u),this.setData({disableds:!0}),uni.navigateBack({delta:1}))},dataFun:function(e){for(var t=[],a=0;a<e.length;a++){var o={};o.id=e[a].id,o.name=e[a].name,o.selectType=e[a].selectType,o.selectRole=e[a].selectRole,o.isHasChild=e[a].isHasChild,o.checked=e[a].checked,o.value=e[a].selectRole+e[a].id+e[a].selectType,t[a]=o}this.setData({checkboxItems:t})},reduceFun:function(e){for(var t=e.length,a={},o=[],l=0;l<t;l++)a[JSON.stringify(e[l])]=!0;for(var s=Object.keys(a),n=0;n<s.length;n++)o.push(JSON.parse(s[n]));return o},cancelChecked:function(e,t){var a=[];if(e&&t){for(var o=0;o<t.length;o++)for(var l=0;l<e.length;l++)e[l].id==t[o].id&&e[l].selectRole==t[o].selectRole&&e[l].selectType==t[o].selectType&&(e.splice(l,1),l-=1);return a=e,a}},seachSchUrl:function(e,t,a){var o,l=e,s=this.limitSelectPerson;if("attendee"==s){var n=r.globalData.StorageUtil.get("attendeeStudentCach");o=1}else if("hoster"==s){n=r.globalData.StorageUtil.get("hosterCach");o=2}else if("recoder"==s){n=r.globalData.StorageUtil.get("recoderCach");o=2}this.getSearchData(o,l,t,a,n)},lower:function(e){console.log(e),this.isHasLower&&(this.seachSchUrl(this.searchValInp,2*this.currentPage,0),this.setData({loadNotice:"加载中"}))},getSearchData:function(e,t,a,o,l){var s=this;r.globalData.ShowMsgUtil.netErrNotice();var n=r.globalData.StorageUtil.get("userInfoCach");wx.request({url:r.globalData.RequestUrl.appointmentRequestUrl.searchPersonnel+"?searchType="+e+"&nameStr="+t+"&take="+a+"&skip="+o,method:"GET",header:{token:n.token},success:function(e){if(console.log("搜素选择人员",e.data.rows),e.data&&200==e.data.code){var t=[],a=e.data.rows.peoples.length;if(a<=0)s.setData({checkboxItems:e.data.rows.peoples});else{for(var o=0;o<e.data.rows.peoples.length;++o){var n={};if(""!=l)var c=s.dealSelectPerson(l,e.data.rows.peoples[o]);n.id=e.data.rows.peoples[o].selectId,n.name=e.data.rows.peoples[o].selectName,n.selectType=e.data.rows.peoples[o].selectType,n.selectRole=e.data.rows.peoples[o].selectRole,n.isHasChild=e.data.rows.peoples[o].isHasChild;var i=e.data.rows.peoples[o].selectRole+e.data.rows.peoples[o].selectId+e.data.rows.peoples[o].selectType;n.value=String(i),n.checked=c,t[o]=n}a!=s.currentPage&&a>=5?s.setData({loadNotice:"上拉加载更多"}):s.setData({loadNotice:"到底了",isHasLower:!1}),s.setData({disableds:!1,currentPage:a,checkboxItems:t})}}else r.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){r.globalData.ShowMsgUtil.showNoneToastByFail()}})},mysearchValLen:function(e){var t=e.detail.valLength,a=e.detail.value;console.log(a),t<=0?this.setData({disableds:!0,checkboxItems:[],currentPage:0}):(this.seachSchUrl(a,5,0),this.setData({searchValInp:a}))}}};t.default=c}}]);