(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-indexModule-pages-totalMeterOfWater-totalMeterOfWater"],{2150:function(e,t,a){"use strict";a.r(t);var i=a("9576"),o=a.n(i);for(var n in i)"default"!==n&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=o.a},3949:function(e,t,a){var i=a("aef7");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=a("4f06").default;o("6b57a516",i,!0,{sourceMap:!1,shadowMode:!1})},8707:function(e,t){var a="/static/pages/indexModule/resources/pic",i={image:a,wx:"".concat(a,"/wx.png"),cardBg:"".concat(a,"/card-bg.png"),bankCard:"".concat(a,"/bankCard.png"),paymentCode:"".concat(a,"/paymentCode.png"),payroll:"".concat(a,"/payroll.png"),integral:"".concat(a,"/integral.png"),bandCardPic:"".concat(a,"/card-pic.jpg"),deviceOnLine:"".concat(a,"/device_on-line.png"),deviceOffLine:"".concat(a,"/device_off-line.png"),redLine:"".concat(a,"/red-line.png"),blueLine:"".concat(a,"/blue-line.png"),switchOpen:"".concat(a,"/switch_open.png"),switchClose:"".concat(a,"/switch_close.png"),paycode:"".concat(a,"/paycode.png"),switchForbit:"".concat(a,"/switch_forbit.png"),emmterOneWayOff:"".concat(a,"/emmter_one_way_off.png"),emmterOneWayOn:"".concat(a,"/emmter_one_way_on.png"),errIconImg:"".concat(a,"/errorNotice.png"),eleWalletImg:"".concat(a,"/ele-wallet.png"),eleWalletLImg:"".concat(a,"/ele-wallet-l.png"),eleWalletIKmg:"".concat(a,"/ele-wallet-2.png"),waterWalletImg:"".concat(a,"/water-wallet.png"),zywaterImg:"".concat(a,"/zy-water.png"),hotWaterImg:"".concat(a,"/hostwater.png"),yueWalletImg:"".concat(a,"/yue-wallet.png"),returnWalletImg:"".concat(a,"/return-wallet.png"),recordWalletImg:"".concat(a,"/record-wallet.png"),resultSuccessImg:"".concat(a,"/successPay.png"),resultFailPayImg:"".concat(a,"/failPay.png")};e.exports=i},"877a":function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"page"},[e.nothing?e._e():a("v-uni-view",[a("v-uni-view",{staticClass:"page__bd background-content"},[a("v-uni-view",{staticClass:"background-up",style:"width: "+.92*e.windowWidth+"px"},e._l(e.roomsDeviceArr.arr,(function(t,i){return a("v-uni-view",{key:i,staticStyle:{"border-bottom":"20rpx solid rgba(204,204,204,0.5)"}},[a("v-uni-view",{staticClass:"weui-cells_after-title",staticStyle:{margin:"0 15px"}},[a("v-uni-view",{staticClass:"myui-cell"},[a("v-uni-view",{staticClass:"weui-cell__ft wx-font"},[e._v("截止时间："+e._s(e.roomsDeviceArr.time))])],1)],1),a("v-uni-view",{staticClass:"wx-device"},[a("v-uni-text",{staticStyle:{"font-size":"12px",color:"rgb(60,58,80)"}},[e._v(e._s(t.type)+"：")])],1),a("v-uni-view",{staticClass:"wx-show"},[a("v-uni-view",{staticClass:"show-items items-start"},[e._v(e._s(t.count[0]))]),a("v-uni-view",{staticClass:"show-items items-black"},[e._v(e._s(t.count[1]))]),a("v-uni-view",{staticClass:"show-items items-black"},[e._v(e._s(t.count[2]))]),a("v-uni-view",{staticClass:"show-items items-black"},[e._v(e._s(t.count[3]))]),a("v-uni-view",{staticClass:"show-items items-black"},[e._v(e._s(t.count[4]))]),a("v-uni-view",{staticClass:"items-box-point"},[a("v-uni-view",{staticClass:"items-point"})],1),a("v-uni-view",{staticClass:"show-items items-red",staticStyle:{"background-color":"rgb(32,164,247)"}},[e._v(e._s(t.count[5]))]),a("v-uni-view",{staticClass:"show-items items-end",staticStyle:{"background-color":"rgb(32,164,247)"}},[e._v(e._s(t.count[6]))]),a("v-uni-view",{staticClass:"show-items",staticStyle:{color:"black"}},[e._v(e._s(t.size))])],1),4!=t.deviceType?a("v-uni-view",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"center",margin:"23px 0px 15px 0"}},[a("v-uni-image",{style:"width: "+.66*e.windowWidth+"px;height:3px;",attrs:{src:e.ImageUrl.blueLine}})],1):e._e(),4==t.deviceType?a("v-uni-view",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"center",margin:"23px 0px 15px 0"}},[a("v-uni-image",{style:"width: "+.66*e.windowWidth+"px;height:3px;",attrs:{src:e.ImageUrl.redLine}})],1):e._e(),4==t.deviceType?a("v-uni-view",[a("v-uni-view",[t.pageData.isSummary?a("v-uni-view",{staticStyle:{margin:"20px 15px 15px"}},[a("v-uni-view",[a("v-uni-view",{staticClass:"weui-cell__bd"},[e._v("设备类型：总表")]),a("v-uni-view",{staticClass:"weui-cell__bd "},[e._v("总表无法操作")])],1)],1):a("v-uni-view",{staticClass:"wx-button",style:"height:"+.57*e.windowHeight*.42+"px;"},[e._v("总闸开关"),a("v-uni-view",{staticClass:"button-box",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.bindTotalSwitch.apply(void 0,arguments)}}},[a("v-uni-image",{staticStyle:{width:"80px",height:"80px"},attrs:{src:t.pageData.image}}),a("v-uni-text",{staticStyle:{"font-size":"12px",color:"rgb(182,181,193)","margin-top":"6px"}},[e._v(e._s(t.pageData.msg))])],1)],1)],1),a("v-uni-view",[a("v-uni-view",{staticClass:"background-bottom"},[t.pageData.isMuchWay&&!t.pageData.isSummary?a("v-uni-view",{staticClass:"emmter-box"},[a("v-uni-text",[e._v("电表分表")]),a("v-uni-view",{staticClass:"emmter-items"},[a("v-uni-view",{staticClass:"emmter-item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.bindFirstSwitch.apply(void 0,arguments)}}},[a("v-uni-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.pageData.firstIsOpenImage}}),a("v-uni-text",[e._v("一路")])],1),a("v-uni-view",{staticClass:"emmter-item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.bindSecondSwitch.apply(void 0,arguments)}}},[a("v-uni-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.pageData.secondIsOpenImage}}),a("v-uni-text",[e._v("二路")])],1)],1)],1):e._e()],1)],1)],1):e._e()],1)})),1),a("v-uni-view",{staticClass:"background-top",style:"height: "+.3*e.windowHeight+"px; width: 100%;background-color: rgb(32,164,247);"})],1)],1),e.nothing?a("v-uni-view",{staticClass:"nomore"},[e._v("暂无设备,请安装!")]):e._e()],1)},n=[]},9576:function(e,t,a){"use strict";a("b680"),a("d3b7"),a("ac1f"),a("25f0"),a("1276"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=getApp(),o=a("8707"),n={data:function(){return{windowHeight:0,windowWidth:0,pageData:{},ImageUrl:o,showWaterData:[],showEleData:[],roomsDeviceArr:[1,2,3],nothing:!1,disable:!0}},components:{},props:{},onLoad:function(e){console.log(e);i.globalData.StorageUtil.get("userInfoCach");this.setData({windowHeight:wx.getSystemInfoSync().windowHeight,windowWidth:wx.getSystemInfoSync().windowWidth});var t=i.globalData.StorageUtil.get("roomDevices");if(console.log(t),t){var a=e.roomId;this.getUsageByRoom(a,t)}else this.setData({nothing:!0})},methods:{getUsageByRoom:function(e,t){var a=this;i.globalData.ShowMsgUtil.netErrNotice(),wx.showNavigationBarLoading();var o={roomId:e},n=i.globalData.StorageUtil.get("userInfoCach");wx.request({url:i.globalData.RequestUrl.baseRequestUrl.getUsageByRoom,method:"GET",data:o,header:{token:n.token},success:function(e){if(console.log("获取水电信息返回",e.data),e.data&&200===e.data.code){var o=a.reduceData(e.data.data,t),n={time:e.data.data.today,arr:o};console.log(n),a.setData({roomsDeviceArr:n})}else i.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(e){i.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideNavigationBarLoading()}})},reduceData:function(e,t){console.log(t);for(var a=this.dealWaterData(e.usageTotalColdWater),i=this.dealWaterData(e.usageTotalHotWater),o=this.dealWaterData(e.usageTotalEle),n=[],s=0,c=0;c<t.length;c++){var l={};if(4==t[c].deviceType||2==t[c].deviceType||8==t[c].deviceType){if(2==t[c].deviceType&&(l={type:"冷水表用水量",count:a,size:"m³",deviceType:2}),8==t[c].deviceType&&(l={type:"热水表用水量",count:i,size:"m³",deviceType:8}),4==t[c].deviceType){var r=this.reduceEleData(t[c]);console.log(r),l={type:"电表用电量",count:o,size:"kW.h",deviceType:4,pageData:r}}n[s]=l,s++}else console.log(t[c].deviceType)}return n},reduceEleData:function(e){var t={};return console.log("deviceObj - ",e),e.deviceCacheToApp.status.online?(t.status="在线",t.statusImage=o.deviceOnLine):(t.status="离线",t.statusImage=o.deviceOffLine),t.lastLoginTime=i.globalData.PublicUtil.formatTimeTwo(e.deviceCacheToApp.lastLoginTime,"Y-M-D h:m:s"),t.deviceCode=e.deviceCacheToApp.deviceCode,t.deviceName=e.deviceName,t.deviceVersion=e.deviceVersion,t.isSummary=e.deviceCacheToApp.attributes.summary,t.isMuchWay=!0,1==e.deviceCacheToApp.status.firstIsOpen?(t.firstIsOpen=1,t.firstIsOpenImage=o.emmterOneWayOn):(t.firstIsOpen=0,t.firstIsOpenImage=o.emmterOneWayOff),1==e.deviceCacheToApp.status.secondIsOpen?(t.secondIsOpen=1,t.secondIsOpenImage=o.emmterOneWayOn):(t.secondIsOpen=0,t.secondIsOpenImage=o.emmterOneWayOff),t.online=e.deviceCacheToApp.status.online,e.deviceCacheToApp.status.online?(t.isOpen=e.deviceCacheToApp.status.isOpen,1==e.deviceCacheToApp.status.isOpen?(t.image=o.switchClose,t.msg='点击此处，将"关闭"电表总闸'):(t.image=o.switchOpen,t.msg='点击此处，将"开启"电表总闸')):(t.firstIsOpen=0,t.firstIsOpenImage=o.emmterOneWayOff,t.secondIsOpen=0,t.secondIsOpenImage=o.emmterOneWayOff,t.image=o.switchForbit,t.msg="无法连接，请确认检查设备是否通电"),this.setData({pageData:t}),t},bindTotalSwitch:function(){var e=this;if(this.disable){if(!this.pageData.online||this.pageData.isSummary)return;1==this.pageData.isOpen?e.buttonElec(this.pageData.deviceCode,1):0==this.pageData.isOpen?e.buttonElec(this.pageData.deviceCode,2):i.globalData.ShowMsgUtil.showErrorModal("提示","操作失败！")}else i.globalData.ShowMsgUtil.showErrorModal("提示","请勿连续开启！")},bindFirstSwitch:function(){var e=this;if(this.disable){if(!this.pageData.online||this.pageData.isSummary||!this.pageData.isMuchWay)return;1==this.pageData.firstIsOpen?e.buttonElec(this.pageData.deviceCode,3):0==this.pageData.firstIsOpen?e.buttonElec(this.pageData.deviceCode,4):i.globalData.ShowMsgUtil.showErrorModal("提示","操作失败！")}else i.globalData.ShowMsgUtil.showErrorModal("提示","请勿连续开启！")},bindSecondSwitch:function(){var e=this;if(this.disable){if(!this.pageData.online||this.pageData.isSummary||!this.pageData.isMuchWay)return;1==this.pageData.secondIsOpen?e.buttonElec(this.pageData.deviceCode,5):0==this.pageData.secondIsOpen?e.buttonElec(this.pageData.deviceCode,6):i.globalData.ShowMsgUtil.showErrorModal("提示","操作失败！")}else i.globalData.ShowMsgUtil.showErrorModal("提示","请勿连续开启！")},buttonElec:function(e,t){this.setData({disable:!1}),i.globalData.ShowMsgUtil.netErrNotice();var a=this,n=i.globalData.StorageUtil.get("userInfoCach");console.log("电表开启的设备编号",e),wx.request({url:i.globalData.RequestUrl.appoprRequestUrl.operateEle,data:{deviceType:4,deviceCode:e,operateType:1,status:t},header:{token:n.token,"content-type":"application/json"},method:"POST",success:function(e){a.setData({disable:!0}),console.log("电表操作返回--",e.data),e.data&&200==e.data.code?(1==t&&(a.pageData.image=o.switchOpen,a.pageData.msg='点击此处，将"开启"电表总闸',i.globalData.ShowMsgUtil.showSuccessToast("关电表总闸成功",2e3)),2==t&&(a.pageData.image=o.switchClose,a.pageData.msg='点击此处，将"关闭"电表总闸',i.globalData.ShowMsgUtil.showSuccessToast("开电表总闸成功",2e3)),3==t&&(a.pageData.firstIsOpen=!1,a.pageData.firstIsOpenImage=o.emmterOneWayOff,i.globalData.ShowMsgUtil.showSuccessToast("关电表一路成功",2e3)),4==t&&(a.pageData.firstIsOpen=!0,a.pageData.firstIsOpenImage=o.emmterOneWayOn,i.globalData.ShowMsgUtil.showSuccessToast("开电表一路成功",2e3)),5==t&&(a.pageData.secondIsOpen=!1,a.pageData.secondIsOpenImage=o.emmterOneWayOff,i.globalData.ShowMsgUtil.showSuccessToast("关电表二路成功",2e3)),6==t&&(a.pageData.secondIsOpen=!0,a.pageData.secondIsOpen=o.emmterOneWayOn,i.globalData.ShowMsgUtil.showSuccessToast("开电表二路成功",2e3)),a.setData({pageData:a.pageData}),setTimeout((function(){wx.hideToast({})}),2e3)):(i.globalData.ShowMsgUtil.showErrorModal("操作失败",e.data.msg,e.data.code),wx.hideToast({}))},fail:function(){i.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){setTimeout((function(){wx.hideToast({})}),2e3)}})},dealWaterData:function(e){e=e.toFixed(2),console.log(e.toString());var t=[],a=e.toString(),i=a.split(".");i[0].length>5&&(i[0]=i[0].substring(0,5));for(var o=0,n=0;n<5;n++)t[n]=0,5-n<=i[0].length&&(t[n]=i[0].split("")[o],o++);if(o=0,1==i.length)t[5]=0,t[6]=0;else for(var s=5;s<7;s++)t[s]=0,7-s<=i[1].length&&(t[s]=i[1].split("")[o],o++);return t},getWaterInfo:function(e,t){var a=this;i.globalData.ShowMsgUtil.netErrNotice();var o=e.deviceCacheToApp.deviceCode;wx.request({url:i.globalData.RequestUrl.baseRequestUrl.getWaterInfo,data:{deviceCode:o},method:"GET",header:{token:t.token},success:function(e){if(console.log("获取用水量信息返回",e.data),e.data&&200===e.data.code){var t=e.data.rows;a.dealWaterData(t)}else i.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(e){i.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideNavigationBarLoading()}})},getElectricityInfo:function(e,t){var a=this;i.globalData.ShowMsgUtil.netErrNotice();var o=e.deviceCacheToApp.deviceCode;wx.request({url:i.globalData.RequestUrl.baseRequestUrl.getElectricityInfo,data:{deviceCode:o},method:"GET",header:{token:t.token},success:function(e){if(e.data&&200===e.data.code){var t=e.data.rows;a.dealEleData(t)}else i.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(e){i.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideNavigationBarLoading()}})},dealEleData:function(e){var t=[],a=e.usage.toString(),i=a.split(".");i[0].length>5&&(i[0]=i[0].substring(0,5));for(var o=0,n=0;n<5;n++)t[n]=0,5-n<=i[0].length&&(t[n]=i[0].split("")[o],o++);if(o=0,1==i.length)t[5]=0,t[6]=0;else for(var s=5;s<7;s++)t[s]=0,7-s<=i[1].length&&(t[s]=i[1].split("")[o],o++);this.setData({showEleData:t})},dealPageData:function(e){var t={};return e.deviceCacheToApp.status.online?(t.status="在线",t.statusImage=o.deviceOnLine):(t.status="离线",t.statusImage=o.deviceOffLine),t.lastLoginTime=i.globalData.PublicUtil.formatTimeTwo(null==e.deviceCacheToApp.lastLoginTime?(new Date).getTime():e.deviceCacheToApp.lastLoginTime,"Y-M-D h:m:s"),t.deviceCode=e.deviceCacheToApp.deviceCode,t.deviceName=e.deviceName,t.deviceVersion=e.deviceVersion,console.log("deviceObj"+e.deviceCacheToApp),t}}};t.default=n},"976b":function(e,t,a){"use strict";a.r(t);var i=a("877a"),o=a("2150");for(var n in o)"default"!==n&&function(e){a.d(t,e,(function(){return o[e]}))}(n);a("c7f8");var s,c=a("f0c5"),l=Object(c["a"])(o["default"],i["b"],i["c"],!1,null,"0e63cdcb",null,!1,i["a"],s);t["default"]=l.exports},aef7:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".background-content[data-v-0e63cdcb]{position:relative;z-index:1}.background-up[data-v-0e63cdcb]{position:absolute;z-index:2;margin:3% 4% 0 4%;background-color:#fff;\r\n  /* width: 92%; */box-shadow:0 0 2px 0 rgba(110,113,176,.5);display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;padding:%?30?% %?0?% 0;font-size:15px}.myui-cell[data-v-0e63cdcb]{position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center}.myui-cell-image[data-v-0e63cdcb]{background-color:#7ae376}.wx-font[data-v-0e63cdcb]{overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;/* 设置 需要显示的行数 */font-size:12px;color:#323549}.wx-device[data-v-0e63cdcb]{margin:%?35?% 15px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}\r\n\r\n/* 电量显示 */.wx-show[data-v-0e63cdcb]{\r\n  /* border: 1px skyblue solid; */margin:0 auto;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.show-items[data-v-0e63cdcb]{width:32px;height:32px;font-size:20px;color:#fff;text-align:center;line-height:32px;margin-left:3px}.items-black[data-v-0e63cdcb]{background-color:#7b8a96}.items-red[data-v-0e63cdcb]{\r\n  /* margin-left: 13px; */background-color:#e45757}.items-start[data-v-0e63cdcb]{background-color:#7b8a96;border-top-left-radius:10px;border-bottom-left-radius:10px}.items-end[data-v-0e63cdcb]{background-color:#e45757;border-top-right-radius:10px;border-bottom-right-radius:10px}.items-box-point[data-v-0e63cdcb]{width:23px;height:23px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.items-point[data-v-0e63cdcb]{width:%?12?%;height:%?12?%;border-radius:%?6?%;background-color:#000;margin:0 auto;margin-top:20px}\r\n\r\n/* 总闸开关 */.wx-button[data-v-0e63cdcb]{width:86%;margin:auto;font-size:13px;color:#3c3a50}.button-box[data-v-0e63cdcb]{height:86%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}\r\n\r\n/* 分路开关 */.emmter-box[data-v-0e63cdcb]{margin:0 4% 0 4%}.emmter-items[data-v-0e63cdcb]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.emmter-item[data-v-0e63cdcb]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin:15px 0 0 30px}.nomore[data-v-0e63cdcb]{margin-top:%?100?%;text-align:center;color:#999}",""]),e.exports=t},c7f8:function(e,t,a){"use strict";var i=a("3949"),o=a.n(i);o.a}}]);