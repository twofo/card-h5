(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repairModule-pages-index"],{"258a":function(t,e,a){var i=a("9269");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("162e0a24",i,!0,{sourceMap:!1,shadowMode:!1})},"29bf":function(t,e,a){var i=a("f9b1");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("786f59d4",i,!0,{sourceMap:!1,shadowMode:!1})},"3c0e":function(t,e,a){"use strict";a.r(e);var i=a("5b59"),n=a("611b");for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);a("5db3");var o,l=a("f0c5"),r=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"09d86062",null,!1,i["a"],o);e["default"]=r.exports},"4b87":function(t,e,a){"use strict";a.r(e);var i=a("a0c9"),n=a("f48a");for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);a("d772");var o,l=a("f0c5"),r=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"aca3ff84",null,!1,i["a"],o);e["default"]=r.exports},"5b59":function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticClass:"page"},[a("v-uni-view",{staticClass:"page__bd",staticStyle:{"background-color":"#f7f7f7"}},[0==t.tabBarIndex?[a("mp-index",{attrs:{backgroundImage:t.ImageUrl.bgRepairHeader,list:t.pendingLists,repairNumber:t.repairNumber,sum:t.sum,listLength:t.indexListLength,height:t.repairHeight},on:{pull:function(e){arguments[0]=e=t.$handleEvent(e),t.bindPullUp.apply(void 0,arguments)}}})]:t._e(),1==t.tabBarIndex?[a("navbar",{staticClass:"reReNav",attrs:{tabs:t.tabs},on:{clickTabs:function(e){arguments[0]=e=t.$handleEvent(e),t.bindClickTabs.apply(void 0,arguments)}}}),a("repair-list",{attrs:{list:t.list,listLength:t.workOrderListLength},on:{call:function(e){arguments[0]=e=t.$handleEvent(e),t.bindCallPhone.apply(void 0,arguments)},pull:function(e){arguments[0]=e=t.$handleEvent(e),t.bindPullUp.apply(void 0,arguments)}}})]:t._e(),2==t.tabBarIndex?[a("v-uni-view",{staticClass:"background-up"},[a("v-uni-view",{staticClass:"background-up-top",style:"width: "+.92*t.windowWidth+"px;border-radius: 10px;"},[a("v-uni-view",{staticClass:"wx-items"},t._l(t.pageData.showOptions,(function(e,i){return a("v-uni-view",{key:i},[a("v-uni-navigator",{attrs:{url:"/pages/indexModule/pages/messageListOfType/messageListOfType?type="+e.type}},[i<5?a("v-uni-view",{staticClass:"wx-item",style:"height:60px;width: 32px;margin:"+.26*t.windowHeight*.08+"px "+.92*t.windowWidth*.05+"px;"},[a("v-uni-image",{staticClass:"item-image",attrs:{src:e.image}}),a("v-uni-image",{staticClass:"item-red-point",attrs:{src:e.allUnreadImage}}),a("v-uni-text",{staticClass:"item-name"},[t._v(t._s(e.name))])],1):t._e()],1)],1)})),1)],1),a("v-uni-view",{staticClass:"msg-title"},[a("v-uni-view",{staticClass:"myui-cell"},[a("v-uni-view",{staticClass:"weui-cell__bd"},[t._v("今日消息（"+t._s(t.pageData.todayNewNumber)+"/5）")]),a("v-uni-view",{staticClass:"weui-cell__ft myui-read",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.bindToAllRead.apply(void 0,arguments)}}},[a("v-uni-view",{staticStyle:{display:"flex","justify-content":"center"}},[a("v-uni-image",{staticStyle:{width:"18px",height:"15px",margin:"0px 8px"},attrs:{src:t.ImageUrlApp.msgUnread}})],1),a("v-uni-view",[t._v("一键全部已读")])],1)],1)],1),""!==t.pageData.showOfNewest?a("v-uni-view",[a("new-lists",{attrs:{alarmNewsList:t.pageData.showOfNewest,height:t.windowHeight-200,itemHeight:106},on:{bindDealMsg:function(e){arguments[0]=e=t.$handleEvent(e),t.bindDealMsg.apply(void 0,arguments)},getMore:function(e){arguments[0]=e=t.$handleEvent(e),t.getMore.apply(void 0,arguments)}}})],1):a("v-uni-view",{staticStyle:{"margin-top":"30%"}},[a("v-uni-view",{staticClass:"weui-loadmore weui-loadmore_line"},[a("v-uni-view",{staticClass:"weui-loadmore__tips weui-loadmore__tips_in-line"},[t._v("暂无数据")])],1),a("v-uni-view",{staticClass:"weui-loadmore weui-loadmore_line weui-loadmore_dot"},[a("v-uni-view",{staticClass:"weui-loadmore__tips weui-loadmore__tips_in-line weui-loadmore__tips_in-dot"})],1)],1)],1),a("v-uni-view",{staticClass:"background-top",style:"height: "+.12*t.windowHeight+"px; width: 100%;background-color: rgb(32,164,247);"}),a("v-uni-view",{staticClass:"background-bottom",style:"height: "+(.88*t.windowHeight-7)+"px; width: 100%;"})]:t._e(),3==t.tabBarIndex?[a("v-uni-view",{staticClass:"user-info"},[a("header-pic",{attrs:{pic:t.pic,userInfoCach:t.userInfoCach,isMine:"true"},on:{userdetail:function(e){arguments[0]=e=t.$handleEvent(e),t.bindUserDetail.apply(void 0,arguments)},qrcode:function(e){arguments[0]=e=t.$handleEvent(e),t.bindqrcode.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"myui-items__header"},[a("v-uni-view",{staticClass:"myui-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getFinishOrder.apply(void 0,arguments)}}},[a("v-uni-image",{staticStyle:{width:"100rpx",height:"100rpx"},attrs:{src:t.ImageUrl.mineFunRecord}}),a("v-uni-text",[t._v("工单统计")])],1),a("v-uni-view",{staticStyle:{height:"130rpx","border-right":"2px #bbb solid",margin:"auto"}}),a("v-uni-view",{staticClass:"myui-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getComment.apply(void 0,arguments)}}},[a("v-uni-image",{staticStyle:{width:"100rpx",height:"100rpx"},attrs:{src:t.ImageUrl.icStars}}),a("v-uni-text",[t._v("综合评价")])],1)],1),a("mine-list",{attrs:{mineList:t.mineList}})]:t._e()],2)],1),a("mp-tabbar",{staticStyle:{position:"fixed",bottom:"0",width:"100%",left:"0",right:"0"},attrs:{list:t.tabBarList,current:t.current},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.tabChange.apply(void 0,arguments)}}})],1)},s=[]},"5db3":function(t,e,a){"use strict";var i=a("258a"),n=a.n(i);n.a},"611b":function(t,e,a){"use strict";a.r(e);var i=a("e582"),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);e["default"]=n.a},9269:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,".user-info[data-v-09d86062]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;background-color:#fff;background:#20a4f7;min-height:%?190?%;padding:%?30?% %?30?% %?0?%}.myui-items__header[data-v-09d86062]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;height:%?200?%;width:%?750?%;background:#fff;margin-bottom:%?30?%;margin-top:%?10?%}.myui-item[data-v-09d86062]{width:50%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}\n\n/* 消息中心 */.background-content[data-v-09d86062]{position:relative;z-index:1}.background-up[data-v-09d86062]{position:absolute;z-index:2;margin:3% 4% 0 4%}.background-up-top[data-v-09d86062]{background-color:#fff;box-shadow:0 0 1px 0 rgba(110,113,176,.5);display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;padding:%?30?% %?0?%;font-size:15px}\n\n/* 头部功能 */.wx-items[data-v-09d86062]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-align-content:center;align-content:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.wx-item[data-v-09d86062]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.item-image[data-v-09d86062]{width:36px;height:36px;position:relative;z-index:10}.item-red-point[data-v-09d86062]{width:10px;height:10px;\n  /* border: 1px skyblue solid; */position:absolute;z-index:11;margin:3px 0 0 30px}.item-name[data-v-09d86062]{margin-top:3px;text-align:center;font-size:11px}\n\n/* 消息列表 */.myui-cell[data-v-09d86062]{position:relative;display:-webkit-box;display:-webkit-flex;display:flex}.msg-title[data-v-09d86062]{margin:4% 2% 0 2%;font-size:13px;color:#575757;height:30px}.myui-read[data-v-09d86062]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.content[data-v-09d86062]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;padding:%?10?% %?20?% 0}.content-ending[data-v-09d86062]{width:100%;color:#bbb;text-align:center;margin:%?30?% auto}",""]),t.exports=e},a0c9:function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticClass:"myui-header reHead"},[a("v-uni-image",{staticStyle:{width:"100%",height:"300rpx"},attrs:{src:t.backgroundImage}})],1),a("v-uni-view",{staticClass:"myui-text"},[t._v("你有"),a("v-uni-text",{staticStyle:{color:"red"}},[t._v(t._s(t.repairNumber))]),t._v("条新进工单")],1),a("v-uni-view",{staticClass:"myui-lists"},[a("repair-list",{attrs:{list:t.list,height:t.height,listLength:t.listLength},on:{pull:function(e){arguments[0]=e=t.$handleEvent(e),t.bindPullUp.apply(void 0,arguments)}}})],1)],1)},s=[]},d772:function(t,e,a){"use strict";var i=a("29bf"),n=a.n(i);n.a},e41e:function(t,e,a){"use strict";var i=a("4ea4");a("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(a("6809")),s={data:function(){return{}},components:{repairList:n.default},props:{list:{type:Array,default:function(){return[]}},btnList:{type:Array,default:function(){return[]}},backgroundImage:{type:String,default:""},repairNumber:{type:Number,default:0},sum:{type:Number,default:0},listLength:{type:Number,default:1},height:{type:Number,default:350}},methods:{bindPullUp:function(){this.listLength!=this.list.length&&(console.log("this.data.listLength----",this.listLength),console.log("this.data.list.length----",this.list.length),this.$emit("pull",{detail:{listLength:this.listLength}}))}}};e.default=s},e582:function(t,e,a){"use strict";var i=a("4ea4");a("ac1f"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,s=i(a("ade3")),o=i(a("11f5")),l=i(a("8836")),r=i(a("4b87")),d=i(a("b35c")),u=i(a("6809")),c=i(a("3e33")),g=i(a("23e1")),h=getApp(),f=a("c2d6"),p=a("ddc5"),b=h.globalData.ImageUrl,w=(h.globalData.ImageUrl,n={data:function(){return{tabBarIndex:0,current:0,navTo:!1,tabBarList:[{text:"首页",iconPath:f.navHomePage,selectedIconPath:f.navHomePagePressed},{text:"工单",iconPath:f.navWorkerOrder,selectedIconPath:f.navWorkerOrderPressed,badge:"New"},{text:"消息",iconPath:f.navNew,selectedIconPath:f.navNewPressed,badge:"New"},{text:"我的",iconPath:f.navMine,selectedIconPath:f.navMinePressed,badge:"New"}],ImageUrl:f,pendingLists:[],repairNumber:0,tabs:["全部","待处理","处理中","已完成"],activeIndex:0,list:[],pic:"",mineList:[],userInfoCach:{},pullDownNumberOfIndex:0,pullDownNumberOfWorkOrder:0,workOrderListLength:1,indexListLength:1,windowHeight:0,windowWidth:0,pageData:{},ImageUrlApp:b,repairHeight:485,slientH:0,statusHeight:0,orderHeight:350,sum:0}},components:{newLists:o.default,mpTabbar:l.default,mpIndex:r.default,navbar:d.default,repairList:u.default,mineList:c.default,headerPic:g.default},props:{},onLoad:function(){var t=h.globalData.SystemInfo.screenHeight,e=h.globalData.SystemInfo.statusBarHeight,a=t-e-310;if(this.setData({repairHeight:a,slientH:t,statusHeight:e}),console.log(t,e,a),0==this.tabBarIndex){var i=[];i=[2],this.getListByStatus(i,5,0)}var n=h.globalData.StorageUtil.get("userInfoCach"),s=[];s=h.globalData.Constant.arrayConstant.maintainAdminCenterList,this.setData({mineList:s,userInfoCach:n}),this.getPicData(),h.globalData.ShowMsgUtil.showLoadToast(),this.setData({windowHeight:wx.getSystemInfoSync().windowHeight,windowWidth:wx.getSystemInfoSync().windowWidth,userInfoCach:n}),this.getOptions(),this.getNewest()},onShow:function(){uni.$on("bindPullUp",this.bindPullUp),uni.$on("bindDealMsg",this.bindDealMsg),uni.$on("getMore",this.getMore),this.disabled=!1},onHide:function(){uni.$off("bindPullUp",this.bindPullUp),uni.$off("bindDealMsg",this.bindDealMsg),uni.$off("getMore",this.getMore)},onUnload:function(){uni.$off("bindPullUp",this.bindPullUp),uni.$off("bindDealMsg",this.bindDealMsg),uni.$off("getMore",this.getMore)},onPullDownRefresh:function(){var t=this;t.setData({pendingLists:[],list:[],pullDownNumberOfIndex:0,pullDownNumberOfWorkOrder:0});var e=[];0==t.tabBarIndex?(e=[2],this.getListByStatus(e,5,0)):1==t.tabBarIndex&&(e=[2,3,4,5],this.getListByStatus(e,5,0))}},(0,s.default)(n,"onPullDownRefresh",(function(){this.getOptions(),this.getNewest()})),(0,s.default)(n,"methods",{tabChange:function(t){console.log("tab change",t.detail.index);var e=t.detail.index;if(this.setData({tabBarIndex:e}),h.globalData.StorageUtil.set("tabBarIndex",e),0==e){this.setData({pendingLists:[],pullDownNumberOfWorkOrder:0});var a=[];a=[2],this.getListByStatus(a,5,0)}else if(1==e){var i=[];i=[2,3,4,5],this.getListByStatus(i,5,0),this.setData({list:[],pullDownNumberOfIndex:0,isInit:!0});var n=this.slientH,s=this.statusHeight,o=uni.createSelectorQuery().in(this),l=this;o.select(".reReNav").boundingClientRect((function(t){console.log(111,t);var e=n-s-t.height-120;console.log(e),l.setData({orderHeight:e})})).exec()}},getMore:function(t){console.log("消息页面点击详情  ------------",t),console.log(this.pageData);var e=t.detail.index;this.type;if(this.pageData.showOfNewest.length>0){this.pageData.showOfNewest[e].childType;var a=this.pageData.showOfNewest[e].id,i=this.pageData.showOfNewest[e].msg;"已读"!=i&&this.markRead({mid:a}),console.log(a),h.globalData.PublicUtil.navigateByUrl(h.globalData.PageUrl.indexPageUrl.messageDetailUrl+"?mid="+a,500)}},getListByStatus:function(t,e,a){var i=this;h.globalData.ShowMsgUtil.netErrNotice();var n=h.globalData.StorageUtil.get("userInfoCach"),s=i.list.length,o=i.pendingLists.length;wx.request({url:h.globalData.RequestUrl.repairRequestUrl.selectRepairsList+"?statusType="+t+"&take="+e+"&skip="+a,method:"GET",header:{token:n.token},success:function(t){if(console.log("查询报修列表返回",t.data),t.data&&200==t.data.code){if(0==i.tabBarIndex){i.pullDownNumberOfIndex++;var e=i.dealOfIndex(t.data.rows.lists);i.setData({indexListLength:o,pendingLists:e,repairNumber:t.data.rows.number})}else if(1==i.tabBarIndex){i.pullDownNumberOfWorkOrder++;var a=i.deal(t.data.rows.lists);console.log(a),i.setData({workOrderListLength:s,list:a})}}else h.globalData.ShowMsgUtil.showErrorModal("请求失败",t.data.msg,t.data.code)},fail:function(){h.globalData.ShowMsgUtil.showErrorModal("请求失败","后台连接失败！")},complete:function(){wx.hideToast()}})},dealOfIndex:function(t){for(var e=0;e<t.length;e++){var a=[{btnName:"处理",btnBind:"toDeal"}];t[e].deviceName=p.deviceType(t[e].deviceTypeId),t[e].statusName=p.status(t[e].repairStatus),t[e].image=null!=t[e].images?t[e].images[0]:"",t[e].btnList=a}return t},bindClickTabs:function(t){console.log("navbar组件点击",t.detail.activeIndex);var e=t.detail.activeIndex;this.setData({list:[],pullDownNumberOfWorkOrder:0,activeIndex:e}),this.dealStatusByActiveIndex(e,5,0)},dealStatusByActiveIndex:function(t,e,a){var i=[];0==t?(i=[2,3,4,5],this.getListByStatus(i,e,a)):1==t?(i=[2],this.getListByStatus(i,e,a)):2==t?(i=[3],this.getListByStatus(i,e,a)):3==t&&(i=[4,5],this.getListByStatus(i,e,a))},deal:function(t){for(var e=0;e<t.length;e++){t[e].deviceName=p.deviceType(t[e].deviceTypeId),t[e].statusName=p.status(t[e].repairStatus),t[e].image=null!=t[e].images?t[e].images[0]:"";var a={},i=[];if(1==t[e].repairStatus)a={},a.btnName="处理",a.btnBind="toDeal",i[0]=a;else if(2==t[e].repairStatus)a={},a.btnName="处理",a.btnBind="toDeal",i[0]=a;else if(3==t[e].repairStatus){var n=null==t[e].toMaintainTime?"暂未确定":t[e].toMaintainTime;t[e].msg="维修时间："+n,a={},a.index=3,a.btnName="查看详情",a.btnBind="toDetailOfMaintain",i[0]=a,a={},a.btnName="维修完成",a.btnBind="toFinish",i[1]=a}else if(4==t[e].repairStatus||5==t[e].repairStatus||6==t[e].repairStatus){var s=null==t[e].toMaintainTime?"暂未确定":t[e].toMaintainTime;t[e].msg="维修时间："+s,a={},a.index=4,a.btnName="查看详情",a.btnBind="toDetailOfMaintain",i[0]=a}t[e].btnList=i}return t},getPicData:function(){var t=this;h.globalData.ShowMsgUtil.netErrNotice(),wx.request({url:h.globalData.RequestUrl.baseRequestUrl.getImage,header:{token:t.userInfoCach.token},method:"GET",success:function(e){console.log("获取头像",e.data),e.data&&200===e.data.code&&t.setData({pic:e.data.rows.url})},fail:function(){h.globalData.ShowMsgUtil.showErrorModal("请求失败","后台连接失败！")}})},getFinishOrder:function(){h.globalData.PublicUtil.navigateByUrl(h.globalData.PageUrl.repairPageUrl.finishOrderStatisticsUrl,500)},getComment:function(){h.globalData.PublicUtil.navigateByUrl(h.globalData.PageUrl.repairPageUrl.commentStatisticsUrl,500)},bindPullUp:function(){var t=this;if(0==t.tabBarIndex){var e=[];e=[2],this.getListByStatus(e,5*(this.pullDownNumberOfIndex+1),0)}else 1==t.tabBarIndex&&this.dealStatusByActiveIndex(this.activeIndex,5*(this.pullDownNumberOfWorkOrder+1),0)},bindUserDetail:function(t){h.globalData.PublicUtil.navigateByUrl(h.globalData.PageUrl.minePageUrl.userDetail,500)},bindqrcode:function(){h.globalData.PublicUtil.navigateByUrl(h.globalData.PageUrl.minePageUrl.QRCodeDetail,500)},getOptions:function(){var t=this;h.globalData.ShowMsgUtil.netErrNotice();var e=h.globalData.StorageUtil.get("userInfoCach");wx.request({url:h.globalData.RequestUrl.appoprRequestUrl.unreadStatistics,method:"GET",header:{token:e.token},success:function(e){console.log("获取消息功能选项",e.data.rows),e.data&&200==e.data.code?t.dealShowOfOptions(e.data.rows):h.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){h.globalData.ShowMsgUtil.showNoneToast("后台连接失败",2e3)},complete:function(){wx.hideNavigationBarLoading()}})},dealShowOfOptions:function(t){if(0==t.length)return this.pageData.showOptions=[],void this.setData({pageData:this.pageData});for(var e=[b.msgPay,b.msgAttendance,b.msgAlarm,b.msgOther,b.msgNotice,b.msgRepair],a=0;a<t.length;a++)t[a].image=e[t[a].type-1],t[a].allRead||(t[a].allUnreadImage=b.msgClue);this.pageData.showOptions=t,this.setData({pageData:this.pageData})},getNewest:function(){var t=this;h.globalData.ShowMsgUtil.netErrNotice();var e=h.globalData.StorageUtil.get("userInfoCach");wx.request({url:h.globalData.RequestUrl.appoprRequestUrl.getNewest+"/5",method:"GET",header:{token:e.token},success:function(e){if(console.log("获取当日最新消息",e.data),e.data&&200==e.data.code){var a=e.data.rows.length;t.pageData.todayNewNumber=a,t.setData({pageData:t.pageData}),t.dealShowOfNewest(e.data.rows)}else h.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){h.globalData.ShowMsgUtil.showNoneToast("后台连接失败",2e3)},complete:function(){wx.hideNavigationBarLoading()}})},dealShowOfNewest:function(t){if(0==t.length)return this.pageData.showOfNewest=[],void this.setData({pageData:this.pageData});for(var e=[],a=0;a<t.length;a++){var i={};i.id=t[a].id,i.typeName=this.dealMsgType(t[a].type),i.messageTitle=t[a].messageTitle,i.messageContent=t[a].messageContent,i.messageSendTime=t[a].messageSendTime,i.msg=0==t[a].messageRead?"未读":"已读",i.type=t[a].type,i.childType=t[a].childType,i.extras=t[a].extras,0==t[a].messageRead&&(i.image=b.msgClue),e[a]=i}this.pageData.showOfNewest=e,this.setData({pageData:this.pageData})},dealMsgType:function(t){var e="";switch(t){case 1:e="支付";break;case 2:e="考勤";break;case 3:e="告警";break;case 4:e="其他";break;case 5:e="公告";break;case 6:e="报修";break;default:break}return e},bindToAllRead:function(){var t=!1,e=this.pageData;if(e.showOptions.length>0)for(var a=0;a<e.showOptions.length;a++)e.showOptions[a].allRead||(t=!0);if(e.showOfNewest.length>0)for(var i=0;i<e.showOfNewest.length;i++)"未读"===e.showOfNewest[i].msg&&(t=!0);t&&this.markRead()},markRead:function(){var t=this;h.globalData.ShowMsgUtil.netErrNotice();var e=h.globalData.StorageUtil.get("userInfoCach");wx.request({url:h.globalData.RequestUrl.appoprRequestUrl.markRead,data:{markAll:!0},header:{token:e.token},method:"POST",success:function(e){e.data&&200==e.data.code?(t.getOptions(),t.getNewest()):h.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){h.globalData.ShowMsgUtil.showNoneToast("后台连接失败",2e3)},complete:function(){wx.hideNavigationBarLoading()}})},bindDealMsg:function(t){console.log(2222222222);var e=t.detail.index,a=this.pageData.showOfNewest[e].type,i=this.pageData.showOfNewest[e].childType,n=this.pageData.showOfNewest[e].id,s=this.pageData.showOfNewest[e].extras,o=(s=JSON.parse(s),this.pageData.showOfNewest[e].msg);"已读"!=o&&this.markRead({mid:n}),this.dealMsg(a,i,n,s)},dealMsg:function(t,e,a,i){var n=h.globalData.StorageUtil.get("userInfoCach");2==t&&1==e&&h.globalData.ShowMsgUtil.showErrorModal("注意","请前往考勤打卡页面进行打卡！"),0!==n.personType&&h.globalData.PublicUtil.navigateByUrl(h.globalData.PageUrl.repairPageUrl.repairDetailOfMaintainUrl+"?repairCode="+i.repairCode,500)}}),n);e.default=w},f48a:function(t,e,a){"use strict";a.r(e);var i=a("e41e"),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);e["default"]=n.a},f9b1:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,"/* pages/repairModule/resources/components/index/index.wxss */.myui-header[data-v-aca3ff84]{width:100%;height:%?300?%;background:#00f}.myui-text[data-v-aca3ff84]{text-align:center;margin:%?10?% 0;color:#20a4f7}.myui-lists[data-v-aca3ff84]{padding:%?0?% %?10?%\r\n  /* border: 1px saddlebrown solid; */}",""]),t.exports=e}}]);