(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-appointmentModule-pages-cancelPianoAppiontment-cancelPianoAppiontment"],{1621:function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"toastCover",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.closeCoverFun.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"toastCont",style:"max-height:"+e.maxHeight+"rpx; margin-top:"+e.marginTop+"rpx",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.defaultCover.apply(void 0,arguments)}}},[a("v-uni-view",{staticStyle:{overflow:"hidden"}},[e._t("default")],2)],1)],1)},s=[]},"44be":function(e,t,a){"use strict";var i=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("77df")),s=getApp(),o={data:function(){return{pageObj:{},showNextMsg:!0,showFreeRule:!1,hasToKnowArr:[],meetingId:0,disabled:!1,showDate:!1,type:2}},components:{toastCover:n.default},props:{},onLoad:function(e){console.log(e.meetingId),this.setData({meetingId:e.meetingId,type:e.roomType}),2==e.roomType?uni.setNavigationBarTitle({title:"公共资源_琴房记录_取消预约"}):uni.setNavigationBarTitle({title:"公共资源_练功房记录_取消预约"}),this.getCancelInfo(e.meetingId),this.getChargeInfo()},onUnload:function(){clearTimeout()},methods:{getCancelInfo:function(e){var t=this;s.globalData.ShowMsgUtil.netErrNotice();var a=s.globalData.StorageUtil.get("userInfoCach");wx.request({url:s.globalData.RequestUrl.appointmentRequestUrl.getAppointmentCancelInfo+e+"/detail",method:"GET",header:{token:a.token},success:function(e){if(console.log("获取预约取消信息",e.data),!e.data||200!=e.data.code)return s.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code),void setTimeout((function(){wx.navigateBack({delta:1})}),3e3);t.setData({showDate:!0}),t.dataReduce(e.data.data.userInfo,e.data.data.appointmentInfo,e.data.data.appointmentChargeInfo,e.data.data.appointmentRefundChargeInfo,a.mobile)},fail:function(){s.globalData.ShowMsgUtil.showNoneToastByFail()}})},getChargeInfo:function(){var e=this;s.globalData.ShowMsgUtil.netErrNotice();var t=s.globalData.StorageUtil.get("userInfoCach");wx.request({url:s.globalData.RequestUrl.appointmentRequestUrl.getChargeDetail+"?roomId="+this.meetingId+"&chargeType=2&areaType="+e.type,method:"GET",header:{token:t.token},success:function(t){console.log("获取收费信息",t.data),t.data&&200==t.data.code?e.rulesReduce(t.data.data.serviceChargeSettings):s.globalData.ShowMsgUtil.showErrorModal("请求失败",t.data.msg,t.data.code)},fail:function(){s.globalData.ShowMsgUtil.showNoneToastByFail()}})},rulesReduce:function(e){var t={};t.twelve=e.rateTwentyFouraAndTwelve,t.one=e.rateTwelveAndOne,t.twentyfour=e.rateOverTwentyFour;var a=[{content:"在预约开始时间24小时之前取消预约，收取".concat(t.twentyfour,"%的收手续费；")},{content:"在预约开始时间前12～24小时内取消预约，收取".concat(t.twelve,"%的手续费；")},{content:"在预约开始时间前1～12小时内取消预约，收取".concat(t.one,"%的手续费； ")}];this.setData({hasToKnowArr:a})},dataReduce:function(e,t,a,i,n){var s={};e&&(s.userId=e.id,s.userName=e.name,s.userCode=e.userNo,s.phoneNumber=e.phoneNumber,s.department=null==e.deptName?"无":e.deptName,s.marjor=null==e.majorName?"无":e.majorName,s.personType=e.userType,s.phone=n,0==s.personType?(s.userCodeTxt="学号",s.departmentTxt="院系",s.marjorTxt="专业"):1==s.personType&&(s.userCodeTxt="职工号",s.departmentTxt="部门",s.marjorTxt="校区")),t&&(s.roomAdress=t.addressStr,s.roomId=t.id,s.appiontmentTime=this.timesToTime(t.startTime).yearMountDay+this.timesToTime(t.startTime).hourM+" - "+this.timesToTime(t.endTime).hourM,s.appiontmentReason=""==t.remark?"无":t.remark),a&&(null==a.unitPrice?s.standerFee=0:s.standerFee=a.unitPrice,s.sumTime=a.totalTimeLength,s.freeTimeLength=a.feeTimeLength,s.refFee=a.deductionCharge),i&&(s.shouldRefundCharge=i.shouldRefundCharge,s.serviceCharge=i.serviceCharge,s.realityDeductionMoney=i.realityDeductionMoney),this.setData({pageObj:s})},timesToTime:function(e){var t=new Date(e),a=t.getFullYear()+"-",i=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",n=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",s=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),l=(t.getSeconds()<10?t.getSeconds():t.getSeconds(),{yearMountDay:a+i+n,hourM:s+o});return l},submit:function(){var e=this.meetingId,t=this.pageObj,a=(this.disabled,{appointmentId:e,realityDeductionMoney:t.realityDeductionMoney,serviceCharge:t.serviceCharge});console.log("提交数据",a),this.toCancelPianoAppointment(a),this.setData({disabled:!0})},toCancelPianoAppointment:function(e){s.globalData.ShowMsgUtil.showLoadToast("正在取消...");var t=this;s.globalData.ShowMsgUtil.netErrNotice();var a=s.globalData.StorageUtil.get("userInfoCach");console.log("点击取消,已经开始"),wx.request({url:s.globalData.RequestUrl.appointmentRequestUrl.toCancelAppointment,method:"POST",header:{token:a.token},data:e,success:function(e){if(console.log(e),wx.hideToast({}),!e.data||200!=e.data.code)return t.setData({disabled:!1}),void s.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code);var a=e.data.msg;s.globalData.ShowMsgUtil.showSuccessToast("取消成功",500),s.globalData.PublicUtil.navigateByUrl(s.globalData.PageUrl.authPageUrl.successPageUrl+"?cancelMsg="+a+"&backPage=3&roomType="+t.type,500)},fail:function(){console.log("请求失败"),t.setData({disabled:!1}),s.globalData.ShowMsgUtil.showNoneToastByFail()}})},nextTap:function(){var e=this.showNextMsg;e=!1,this.setData({showNextMsg:e})},freeRule:function(){var e=this.showFreeRule;e=!0,this.setData({showFreeRule:e})},closeCover:function(e){var t=e.detail.closeCover,a=t;this.setData({showFreeRule:a})}}};t.default=o},"45fd":function(e,t,a){"use strict";a.r(t);var i=a("c85a"),n=a.n(i);for(var s in i)"default"!==s&&function(e){a.d(t,e,(function(){return i[e]}))}(s);t["default"]=n.a},"55c3":function(e,t,a){"use strict";var i=a("86fc"),n=a.n(i);n.a},"55f5":function(e,t,a){"use strict";var i;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.showDate?a("v-uni-view",{staticClass:"page"},[a("v-uni-view",[a("v-uni-view",{staticClass:"cancelTitle"},[e._v("预约人信息")]),a("v-uni-view",{staticClass:"weui-cells"},[a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("姓 名：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.userName))])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v(e._s(e.pageObj.userCodeTxt)+"：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.userCode))])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v(e._s(e.pageObj.departmentTxt)+"：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.department))])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v(e._s(e.pageObj.marjorTxt)+"：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.marjor))])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("手机号：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.phoneNumber))])],1)],1)],1),a("v-uni-view",[a("v-uni-view",{staticClass:"cancelTitle"},[e._v("房间信息")]),a("v-uni-view",{staticClass:"weui-cells"},[a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("房间地址：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.roomAdress))])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("预约时间：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.appiontmentTime))])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("备注：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.appiontmentReason))])],1)],1),e.showNextMsg?a("v-uni-view",{staticClass:"page__bd page__bd_spacing",staticStyle:{"margin-top":"60rpx"}},[a("v-uni-button",{staticClass:"weui-btn",attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.nextTap.apply(void 0,arguments)}}},[e._v("下 一 步")])],1):e._e(),e.showNextMsg?e._e():a("v-uni-view",[a("v-uni-view",{staticClass:"cancelTitle"},[e._v("收费")]),a("v-uni-view",{staticClass:"weui-cells"},[a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("收费标准：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.standerFee)+" 元 / 小时")])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("总计时长：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.sumTime)+" 小时")])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("消费免费时长：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.freeTimeLength)+" 小时")])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("应收金额：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.refFee)+" 元")])],1)],1),a("v-uni-view",{staticClass:"cancelTitle"},[e._v("退费")]),a("v-uni-view",{staticClass:"weui-cells"},[a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("应退金额：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.shouldRefundCharge)+" 元")])],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("手 续 费：")]),a("v-uni-view",{staticClass:"myui-cell__bf rightflex"},[a("v-uni-text",[e._v(e._s(e.pageObj.serviceCharge)+" 元")]),a("v-uni-view",[a("v-uni-text",{staticClass:"noticeFont noticeDistance ",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.freeRule.apply(void 0,arguments)}}},[e._v("扣费说明")]),a("v-uni-icon",{staticClass:"iconStyle",attrs:{type:"warn",size:"14",color:"#20A4F7"}})],1)],1)],1),a("v-uni-view",{staticClass:"myui-cell  "},[a("v-uni-view",{staticClass:"myui-cell__bd contTitle"},[e._v("实退金额：")]),a("v-uni-view",{staticClass:"myui-cell__bf"},[e._v(e._s(e.pageObj.realityDeductionMoney)+" 元")])],1)],1),a("v-uni-view",{staticClass:"page__bd page__bd_spacing",staticStyle:{"margin-top":"60rpx","margin-bottom":"270rpx"}},[a("v-uni-button",{staticClass:"weui-btn",attrs:{type:"primary",disabled:e.disabled},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("提 交")])],1)],1)],1),e.showFreeRule?a("toast-cover",{attrs:{maxHeight:"710",marginTop:"120"},on:{closeCover:function(t){arguments[0]=t=e.$handleEvent(t),e.closeCover.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"coverContent"},[a("v-uni-view",{staticClass:"hasToKnow noticeFont"},[e._v("手续费说明")]),a("v-uni-view",{staticClass:"hasToKnowBox"},e._l(e.hasToKnowArr,(function(t,i){return a("v-uni-view",{key:i,staticClass:"hasToKnowCont"},[a("v-uni-view",{staticClass:"hasToKnowTxt"},[e._v(e._s(t.content))])],1)})),1)],1)],1):e._e()],1):e._e()},s=[]},"5d55":function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,"/* components/common/toastCover/toastCover.wxss */.toastCover[data-v-72cd8060]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;z-index:99999;overflow:hidden;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.toastCont[data-v-72cd8060]{width:75%;overflow:scroll;background:#fff;border-radius:%?22?%;padding:%?0?% %?50?% %?0?% %?50?%;box-sizing:border-box;border-bottom:%?60?% solid #fff;border-top:%?42?% solid #fff}",""]),e.exports=t},"77df":function(e,t,a){"use strict";a.r(t);var i=a("1621"),n=a("45fd");for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a("55c3");var o,l=a("f0c5"),c=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"72cd8060",null,!1,i["a"],o);t["default"]=c.exports},8141:function(e,t,a){"use strict";var i=a("b74f"),n=a.n(i);n.a},"86fc":function(e,t,a){var i=a("5d55");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("d376ffba",i,!0,{sourceMap:!1,shadowMode:!1})},b74f:function(e,t,a){var i=a("ede9");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("4f06").default;n("cf92a0f0",i,!0,{sourceMap:!1,shadowMode:!1})},c85a:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{closeCover:!0}},components:{},props:{maxHeight:{type:String,default:"934"},marginTop:{type:String,default:"0"}},methods:{closeCoverFun:function(){var e=this.closeCover;e=!e;var t={closeCover:e};this.setData({closeCover:e}),this.$emit("closeCover",{detail:t})},defaultCover:function(){var e=this.closeCover,t={closeCover:!0};this.setData({closeCover:e}),this.$emit("closeCover",{detail:t})}}};t.default=i},c95a:function(e,t,a){"use strict";a.r(t);var i=a("55f5"),n=a("ca41");for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a("8141");var o,l=a("f0c5"),c=Object(l["a"])(n["default"],i["b"],i["c"],!1,null,"430bc744",null,!1,i["a"],o);t["default"]=c.exports},ca41:function(e,t,a){"use strict";a.r(t);var i=a("44be"),n=a.n(i);for(var s in i)"default"!==s&&function(e){a.d(t,e,(function(){return i[e]}))}(s);t["default"]=n.a},ede9:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".myui-cell[data-v-430bc744]{padding:%?26?% %?30?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.myui-cell__bd[data-v-430bc744]{width:36%;font-size:%?28?%!important;font-weight:700}.myui-cell__bf[data-v-430bc744]{width:74%;color:#999}.myui-cell uni-view[data-v-430bc744]{font-size:%?32?%}.contTitle[data-v-430bc744]{float:left;overflow:hidden;text-align:justify;text-align-last:justify}.cancelTitle[data-v-430bc744]{padding:%?20?% %?30?% %?8?%;font-weight:600}.reason[data-v-430bc744]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.reasonTxt[data-v-430bc744]{margin-top:%?22?%;width:100%;height:%?160?%}.noticeFont[data-v-430bc744]{color:#20a4f7;font-size:%?30?%}.rightflex[data-v-430bc744]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.coverContent[data-v-430bc744]{width:100%}.hasToKnow[data-v-430bc744]{text-align:center;letter-spacing:4px;font-size:%?36?%}.hasToKnowBox[data-v-430bc744]{margin-top:%?32?%}.hasToKnowCont[data-v-430bc744]{margin-top:%?30?%}.hasToKnowTxt[data-v-430bc744]{font-size:%?28?%}",""]),e.exports=t}}]);