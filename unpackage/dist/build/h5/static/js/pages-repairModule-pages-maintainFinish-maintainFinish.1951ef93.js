(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repairModule-pages-maintainFinish-maintainFinish"],{"0ddb":function(e,a,t){var i=t("24fb");a=i(!1),a.push([e.i,'uni-textarea[data-v-cb801132]{width:%?700?%;padding:%?25?% 0}.textarea-wrp[data-v-cb801132]{padding:0 %?25?%;background-color:#fff}.weui-textareas[data-v-cb801132]{padding:12px 4px}.box[data-v-cb801132]{padding:%?10?% %?30?%}.myui-cell[data-v-cb801132]{margin-top:%?15?%}.myui-text[data-v-cb801132]{padding-top:%?20?%}.weui-uploader__files[data-v-cb801132]{position:relative}.closes[data-v-cb801132]{width:50px;height:50px;position:relative;top:17px;color:red;left:66px;height:20px;width:20px;z-index:99}.weui-uploader__bds[data-v-cb801132]{margin-bottom:-4px;margin-right:-9px}.myui-cell[data-v-cb801132]{margin-top:%?15?%}.myui-text[data-v-cb801132]{padding-top:%?20?%}.centerBackground[data-v-cb801132]{border-top:#fff;background-color:#fff;margin-bottom:%?20?%;padding-bottom:%?20?%}uni-button[type="primary"][data-v-cb801132]{background-color:#20a4f7}\n/* 报修原因 */.placeholder[data-v-cb801132]{margin:%?10?%;text-align:center;height:1.8em;line-height:1.8em;border-radius:%?60?%;border:1px #20a4f7 solid}.myui-cells__title[data-v-cb801132]{margin-top:1.07em;margin-bottom:.3em;padding-left:5px;padding-right:15px;color:#20a4f7;font-size:14px}.yes[data-v-cb801132]{background-color:#20a4f7;color:#fff}.no[data-v-cb801132]{background-color:#fff;color:#000}',""]),e.exports=a},"52a0":function(e,a,t){"use strict";var i;t.d(a,"b",(function(){return n})),t.d(a,"c",(function(){return s})),t.d(a,"a",(function(){return i}));var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-uni-view",{staticClass:"page"},[t("v-uni-view",{staticClass:"page__bd box"},[t("v-uni-view",{staticClass:"weui-cells weui-cells_after-title"},[t("v-uni-view",{},[t("v-uni-view",{staticClass:"weui-cell__bd"},[t("v-uni-textarea",{staticClass:"weui-textareas",staticStyle:{height:"4.6em"},attrs:{placeholder:"请详细描述维修过程",maxlength:"200"},on:{input:function(a){arguments[0]=a=e.$handleEvent(a),e.bindTextAreaBlur.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"weui-textarea-counter"},[e._v(e._s(e.cursor)+"/200")])],1)],1)],1),t("v-uni-view",{staticClass:"myui-cells__title"},[e._v("请选择维修原因（必填）")]),t("v-uni-view",{staticClass:"page__bd page__bd_spacing"},[t("v-uni-view",{staticClass:"weui-flex"},[t("v-uni-view",{staticClass:"weui-flex__item"},[t("v-uni-view",{class:"placeholder "+(e.reasonList[0].isSelect?"yes":"no"),attrs:{"data-id":"0"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.selectReason.apply(void 0,arguments)}}},[e._v(e._s(e.reasonList[0].name))])],1),t("v-uni-view",{staticClass:"weui-flex__item"},[t("v-uni-view",{class:"placeholder "+(e.reasonList[1].isSelect?"yes":"no"),attrs:{"data-id":"1"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.selectReason.apply(void 0,arguments)}}},[e._v(e._s(e.reasonList[1].name))])],1),t("v-uni-view",{staticClass:"weui-flex__item"},[t("v-uni-view",{class:"placeholder "+(e.reasonList[2].isSelect?"yes":"no"),attrs:{"data-id":"2"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.selectReason.apply(void 0,arguments)}}},[e._v(e._s(e.reasonList[2].name))])],1)],1),t("v-uni-view",{staticClass:"weui-flex"},[t("v-uni-view",{staticClass:"weui-flex__item"},[t("v-uni-view",{class:"placeholder "+(e.reasonList[3].isSelect?"yes":"no"),staticStyle:{width:"20%"},attrs:{"data-id":"3"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.selectReason.apply(void 0,arguments)}}},[e._v(e._s(e.reasonList[3].name))])],1)],1)],1),t("v-uni-view",{staticClass:"weui-cell centerBackground myui-cell"},[t("v-uni-view",{staticClass:"weui-cell__bd"},[t("v-uni-view",{staticClass:"weui-uploader"},[t("v-uni-view",{staticClass:"weui-uploader__hd"},[t("v-uni-view",{staticClass:"weui-uploader__title"},[e._v("拍照上传（选填）")])],1),t("v-uni-view",{staticClass:"weui-uploader__bd "},[t("v-uni-view",{staticClass:"weui-uploader__files",attrs:{id:"uploaderFiles"}},[e._l(e.files,(function(a,i){return[t("v-uni-view",{key:i+"_0",staticClass:"weui-uploader__file",staticStyle:{width:"80px"},attrs:{id:a,"data-ind":i},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.previewImage.apply(void 0,arguments)}}},[t("v-uni-input",{staticStyle:{"margin-top":"-37px"},attrs:{type:"file",accept:"image/*",id:"uploadImage",capture:"camera",onchange:"selectFileImage(this);"}}),t("v-uni-view",{staticClass:"close",attrs:{"data-ind":i},on:{click:function(a){a.stopPropagation(),arguments[0]=a=e.$handleEvent(a),e.close.apply(void 0,arguments)}}},[t("v-uni-image",{staticClass:"closes",attrs:{src:e.img[i]}})],1),t("img",{staticClass:"weui-uploader__img",attrs:{alt:"preview",src:a,id:"index"}})],1)]}))],2),t("v-uni-view",{staticClass:"weui-uploader__input-box",staticStyle:{"margin-top":"13px"}},[t("v-uni-view",{staticClass:"weui-uploader__input",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.chooseImage.apply(void 0,arguments)}}})],1)],1)],1)],1)],1)],1),t("v-uni-view",{staticClass:"page__bd page__bd_spacing button_top"},[t("v-uni-button",{staticClass:"weui-btn",attrs:{type:"primary",disabled:e.disabled,"form-type":"submit"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.confirmFinish.apply(void 0,arguments)}}},[e._v("维修完成")])],1)],1)},s=[]},7052:function(e,a,t){"use strict";var i=t("4ea4");t("99af"),t("a434"),t("4d63"),t("ac1f"),t("25f0"),t("5319"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=i(t("ade3")),s=getApp(),o=(t("ddc5"),t("c2d6")),c=(t("7809"),{data:function(){return(0,n.default)({files:[],imageBase64:[],img:o.icClose,inputText:"",reasonList:[{id:0,name:"自然损耗",isSelect:!0},{id:1,name:"有意破坏",isSelect:!1},{id:2,name:"操作不当",isSelect:!1},{id:3,name:"其他",isSelect:!1}],cursor:0,repairCode:"",disabled:!1},"img",[o.icClose,o.icClose])},components:{},props:{},onLoad:function(e){console.log("------------------------维修完成------------------------"),this.setData({repairCode:e.repairCode})},methods:{selectReason:function(e){for(var a=this.reasonList,t=e.currentTarget.dataset.id,i=0;i<a.length;i++)a[i].isSelect=!1;for(var n=0;n<a.length;n++)a[n].id==t&&(a[n].isSelect=!0);this.setData({reasonList:a})},bindTextAreaBlur:function(e){this.setData({cursor:e.detail.cursor,inputText:e.detail.value})},chooseImage:function(e){var a,t=this;t.files.length<2?(a="android"==e.platform?["拍摄","从相册中选择","取消"]:["拍摄","从相册中选择"],wx.showActionSheet({itemList:a,success:function(e){"0"==e.tapIndex?t.takeCamera():"1"==e.tapIndex&&t.takePhoto()}})):s.globalData.ShowMsgUtil.showErrorModal("只能传两张！","超过上传图片的个数")},takeCamera:function(e){var a=this;wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(e){var t=e.tempFilePaths[0];a.chageBase64(t),a.setData({files:a.files.concat(e.tempFilePaths)})},fail:function(e){s.globalData.ShowMsgUtil.showErrorModal("请稍后再试","选择图片失败！")}})},takePhoto:function(e){var a=this;wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["album"],success:function(e){var t=e.tempFilePaths[0];a.chageBase64(t),a.setData({files:a.files.concat(e.tempFilePaths)})},fail:function(e){s.globalData.ShowMsgUtil.showNoneToastByFail()}})},previewImage:function(e){wx.previewImage({current:e.currentTarget.id,urls:this.files})},chageBase64:function(e){var a=this,t="",i=s.globalData.base64Util.pathToBase64;i(e).then((function(e){t=e;var i=new RegExp("data:image/png;base64,","g"),s=new RegExp("data:image/jpeg;base64,","g"),o=t.replace(i,""),c=o.replace(s,""),r=a.imageBase64.length;a.setData((0,n.default)({},"imageBase64["+r+"]",c))})).catch((function(e){console.error(e)}))},close:function(e){console.log(e),console.log(this.files),console.log(this.files.length),this.files.splice(e.currentTarget.dataset.ind,1),this.imageBase64.splice(e.currentTarget.dataset.ind,1)},confirmFinish:function(){var e=this;s.globalData.ShowMsgUtil.netErrNotice();var a=s.globalData.StorageUtil.get("userInfoCach"),t=e.dealReason(e.reasonList);""!=e.inputText?""!=t?(e.setData({disabled:!0}),s.globalData.ShowMsgUtil.showLoadToast("正在申请..."),wx.request({url:s.globalData.RequestUrl.repairRequestUrl.repairFinish,data:{repairCode:e.repairCode,repairRemarks:e.inputText,repairReasons:t,repairImglist:e.imageBase64},method:"POST",header:{token:a.token,"content-type":"application/json"},success:function(e){console.log("确认拒绝返回",e.data),e.data&&200==e.data.code?(s.globalData.ShowMsgUtil.showSuccessToast("操作成功",2e3),s.globalData.StorageUtil.set("tabBarIndex",1),s.globalData.PublicUtil.reLaunchByUrl(s.globalData.PageUrl.repairPageUrl.index,2e3)):s.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){s.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideLoading({})}})):s.globalData.ShowMsgUtil.showErrorModal("请求失败","原因不能为空！"):s.globalData.ShowMsgUtil.showErrorModal("请求失败","描述不能为空！")},dealReason:function(e){for(var a="",t=0;t<e.length;t++)e[t].isSelect&&(a=e[t].id+1);return a}}});a.default=c},7809:function(e,a,t){t("ac1f"),t("466d")},"7bdf4":function(e,a,t){"use strict";t.r(a);var i=t("7052"),n=t.n(i);for(var s in i)"default"!==s&&function(e){t.d(a,e,(function(){return i[e]}))}(s);a["default"]=n.a},8360:function(e,a,t){"use strict";var i=t("8987"),n=t.n(i);n.a},8987:function(e,a,t){var i=t("0ddb");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=t("4f06").default;n("4e7935c7",i,!0,{sourceMap:!1,shadowMode:!1})},c2d6:function(e,a){var t="/static/pages/repairModule/resources/pic",i={image:t,repairApplyPic:"".concat(t,"/repair_apply.png"),myRepairPic:"".concat(t,"/repair_my.png"),starOn:"".concat(t,"/star_on.png"),starOff:"".concat(t,"/star_off.png"),icCall:"".concat(t,"/ic_call.png"),icProcessBlue:"".concat(t,"/ic_process_blue.png"),icProcessGray:"".concat(t,"/ic_process_gray.png"),navHomePage:"".concat(t,"/nav_home_page.png"),navHomePagePressed:"".concat(t,"/nav_home_page_pressed.png"),navMine:"".concat(t,"/nav_mine.png"),navMinePressed:"".concat(t,"/nav_mine_pressed.png"),navWorkerOrder:"".concat(t,"/nav_worker_order.png"),navWorkerOrderPressed:"".concat(t,"/nav_worker_order_pressed.png"),navNew:"".concat(t,"/nav_new.png"),navNewPressed:"".concat(t,"/nav_new_pressed.png"),bgRepairHeader:"".concat(t,"/bg_repair_header.png"),mineFunRecord:"".concat(t,"/mine_fun_record.png"),icStars:"".concat(t,"/ic_stars.png"),icTypeOther:"".concat(t,"/ic_type_other.png"),icRepairLock:"".concat(t,"/ic_repair_lock.png"),icRepairAmmeter:"".concat(t,"/ic_repair_ammeter.png"),icRepairWatermeter:"".concat(t,"/ic_repair_watermeter.png"),icRepairLamp:"".concat(t,"/ic_repair_lamp.png"),icClose:"".concat(t,"/close.png")};e.exports=i},ddc5:function(e,a){getApp().globalData;function t(e){var a="";return 0==e?a="其它":1==e?a="门锁":2==e?a="水表":3==e?a="消费机":4==e?a="电表":5==e&&(a="空调电表"),a}function i(e){var a="";return 1==e?a="待分配":2==e?a="待接单":3==e?a="处理中":4==e?a="已完成":5==e?a="已评价":6==e&&(a="已拒绝"),a}e.exports={status:i,deviceType:t}},e3b2:function(e,a,t){"use strict";t.r(a);var i=t("52a0"),n=t("7bdf4");for(var s in n)"default"!==s&&function(e){t.d(a,e,(function(){return n[e]}))}(s);t("8360");var o,c=t("f0c5"),r=Object(c["a"])(n["default"],i["b"],i["c"],!1,null,"cb801132",null,!1,i["a"],o);a["default"]=r.exports}}]);