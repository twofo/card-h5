(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-appointmentModule-pages-creatorMeetingList-meetingList"],{"0c51":function(t,e,i){var a=i("835c");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("0cced850",a,!0,{sourceMap:!1,shadowMode:!1})},"0c6e":function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"page"},[i("v-uni-view",{staticClass:"page__bd"},[i("navbar",{staticClass:"navbor",attrs:{id:"navbor",tabs:t.tabs},on:{clickTabs:function(e){arguments[0]=e=t.$handleEvent(e),t.bindClickTabs.apply(void 0,arguments)}}}),i("v-uni-scroll-view",{style:"height: "+(t.windowHeight-t.statusHeight-t.h)+"px;",attrs:{"scroll-y":!0,"lower-threshold":"10","upper-threshold":"10"},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.lower.apply(void 0,arguments)},scroll:function(e){arguments[0]=e=t.$handleEvent(e),t.scroll.apply(void 0,arguments)}}},[0==t.pageObj.creatMeetingList.length||void 0==t.pageObj.creatMeetingList?i("v-uni-view",{staticClass:"myui__bd"},[i("msg-no-data",{attrs:{msg:"暂无数据"}})],1):i("v-uni-view",{staticClass:"myui__bd"},[t._l(t.pageObj.creatMeetingList,(function(e,a){return i("v-uni-view",{key:a,staticStyle:{margin:"9rpx 10rpx"}},[i("v-uni-view",{staticClass:"weui-cells weui-cells_after-title",staticStyle:{margin:"15rpx 0rpx 0rpx"}},[i("v-uni-view",{staticClass:"weui-cell"},[i("v-uni-view",{staticClass:"weui-cell__hd"},[i("v-uni-image",{staticStyle:{"margin-right":"5px","vertical-align":"middle",width:"23px",height:"25px"},attrs:{src:e.statusImage}})],1),i("v-uni-view",{staticClass:"weui-cell__bd"},[t._v(t._s(e.statusName))]),i("v-uni-view",{staticClass:"weui-cell__ft weui-cell__ft_in-access",staticStyle:{"font-size":"14px"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toDetail({id:e.meetingId})}}},[t._v("详情")])],1)],1),i("v-uni-view",{staticClass:"weui-cells weui-cells_after-title",staticStyle:{"font-size":"15px"}},[i("v-uni-view",{on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.toDetail({id:e.meetingId})}}},[i("v-uni-view",{staticClass:"weui-cell meetTitle",staticStyle:{"font-size":"18px","font-weight":"700"}},[t._v(t._s(e.meetingSubject))]),i("v-uni-view",{staticClass:"myui-cell"},[i("v-uni-view",{staticClass:"myui-cell__bd"},[t._v("房间号：")]),i("v-uni-view",{staticClass:"myui-cell__bf"},[t._v(t._s(e.meetingRoomName))])],1),i("v-uni-view",{staticClass:"myui-cell"},[i("v-uni-view",{staticClass:"myui-cell__bd"},[t._v("会议类型：")]),i("v-uni-view",{staticClass:"myui-cell__bf"},[t._v(t._s(e.meetingType))])],1),i("v-uni-view",{staticClass:"myui-cell"},[i("v-uni-view",{staticClass:"myui-cell__bd"},[t._v("开始时间：")]),i("v-uni-view",{staticClass:"myui-cell__bf"},[t._v(t._s(e.meetingStartTime))])],1),i("v-uni-view",{staticClass:"myui-cell"},[i("v-uni-view",{staticClass:"myui-cell__bd"},[t._v("发起人：")]),i("v-uni-view",{staticClass:"myui-cell__bf"},[t._v(t._s(e.meetingInitiator))])],1),i("v-uni-view",{staticClass:"myui-cell"},[i("v-uni-view",{staticClass:"myui-cell__bd"},[t._v("参会人员：")]),i("v-uni-view",{staticClass:"myui-cell__bf"},[t._v(t._s(e.meetingAttendee))])],1),i("v-uni-view",{staticClass:"myui-cell",staticStyle:{"font-size":"14px"}},[i("v-uni-view",{staticClass:"myui-cell__bd"},[t._v("发布于")]),i("v-uni-view",{staticClass:"myui-cell__bf"},[t._v(t._s(e.createTime))])],1)],1),i("v-uni-view",{staticClass:"myui-cell-bottom",staticStyle:{"font-size":"16px"}},t._l(e.btn,(function(a,n){return i("v-uni-view",{key:n,class:" myui-center "+(3!=e.meetingStatus&&-1!=e.meetingStatus||0!=n?"":"dangerNotice ")+(0==n?"myui-cell-bottom__bd ":"myui-cell-bottom__fd")+" ",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.tapClick(a.bindtap,{id:e.meetingId})}}},[t._v(t._s(a.name))])})),1)],1)],1)})),t.nomore?i("v-uni-view",{staticClass:"myui__bd",staticStyle:{"margin-top":"-300rpx"}},[i("msg-no-data",{attrs:{msg:"到底了"}})],1):t._e()],2)],1)],1)],1)},o=[]},3350:function(t,e){var i="/static/pages/appointmentModule/resources/pic",a={image:i,optionAppointmentPic:"".concat(i,"/option_appointment.png"),optionAttendanceApprovePic:"".concat(i,"/option_attendance_approve.png"),optionMakeCardApplyPic:"".concat(i,"/option_make_card_apply.png"),meetingAttendanceListPic:"".concat(i,"/meeting_attendance_list.png"),meetingAttendanceSignInPic:"".concat(i,"/meeting_attendance_sign_in.png"),blueRecord:"".concat(i,"/blueRecord.png"),closeDefault:"".concat(i,"/closeDefault.png"),closeOpen:"".concat(i,"/closeOpen.png"),loadingPic:"".concat(i,"/loading.png"),checkPendingPic:"".concat(i,"/check_pending.png"),approvePic:"".concat(i,"/approve.png"),unapprovePic:"".concat(i,"/unapprove.png"),nostartPic:"".concat(i,"/nostart.png"),readyStartPic:"".concat(i,"/action.png"),submitCluePic:"".concat(i,"/submit_clue.png"),meetingRoomSmallPic:"".concat(i,"/meeting_room_small.png"),meetingRoomMiddlePic:"".concat(i,"/meeting_room_middle.png"),meetingRoomBigPic:"".concat(i,"/meeting_room_big.png"),meetingRoomFrobidPic:"".concat(i,"/meeting_room_frobid.png"),requiredPic:"".concat(i,"/required.png"),attendaceRightPic:"".concat(i,"/right.png"),attendaceErrorPic:"".concat(i,"/error.png"),readyStartingPic:"".concat(i,"/stating.png"),uploadImgPic:"".concat(i,"/Group.png"),blueSignPic:"".concat(i,"/blueSign.png"),changGuanAppiontPic:"".concat(i,"/PIM.png"),meetingRecordPic:"".concat(i,"/meetingRecord.png"),meetingRoomPic:"".concat(i,"/meetingRoom.png"),pianoRoomPic:"".concat(i,"/pianoRoom.png"),dancingPic:"".concat(i,"/dancing.png"),dancingListPic:"".concat(i,"/dancingList.png"),meetingOutPic:"".concat(i,"/meetinOut.png")};t.exports=a},"4d77":function(t,e,i){"use strict";var a=i("0c51"),n=i.n(a);n.a},"835c":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,'.myui-cell[data-v-450c5c02]{padding:%?6?% %?35?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.myui-cell-bottom[data-v-450c5c02]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;color:#20a4f7;-webkit-align-content:center;align-content:center\r\n\t/*align-items: center; */}.myui-cell-bottom[data-v-450c5c02]{padding:10px 15px;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.myui-cell-bottom[data-v-450c5c02]:before{content:" ";position:absolute;left:0;top:0;right:0;height:1px;border-top:%?1?% solid #e5e5e5;color:#d9d9d9;left:15px}.myui-cell-bottom[data-v-450c5c02]:first-child:before{display:none}.myui-cell-bottom__bd[data-v-450c5c02]{width:50%}.myui-cell-bottom__fd[data-v-450c5c02]{width:50%;border-left:%?3?% #20a4f7 solid}.myui-cell__bd[data-v-450c5c02]{width:25%}.myui-cell__bf[data-v-450c5c02]{width:75%;color:#999}.myui-center[data-v-450c5c02]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.dangerNotice[data-v-450c5c02]{\r\n\t/*删除按钮 红色提示*/color:red}.meetTitle[data-v-450c5c02]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:93%;display:block}.navbor[data-v-450c5c02]{height:%?100?%}',""]),t.exports=e},"9e94":function(t,e,i){"use strict";i.r(e);var a=i("a778"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},a778:function(t,e,i){"use strict";var a=i("4ea4");i("ac1f"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("b35c")),o=a(i("da5f")),l=getApp(),c=i("3350"),s={data:function(){return{pageObj:{creatMeetingList:[]},imageObj:c,tabs:["全部","处理中","未完成","已完成","已拒绝"],activeIndex:0,pullDownNumber:0,windowHeight:0,h:0,statusHeight:23,nomore:!1,isCanLoad:!0,attanceCount:0,scrollTop:0,meetingType:["内部会议","开放式会议"]}},components:{navbar:n.default,msgNoData:o.default},onLoad:function(t){var e=this,i=l.globalData.SystemInfo.statusBarHeight;console.log(i),uni.setNavigationBarTitle({title:"公共资源_会议记录"}),this.setData({statusHeight:i,windowHeight:wx.getSystemInfoSync().windowHeight});var a=uni.createSelectorQuery().in(this);a.select("#navbor").boundingClientRect((function(t){console.log("获取元素高度",t),e.setData({h:50})})).exec()},onShow:function(){this.setData({nomore:!1}),this.attanceCount=0,this.isCanLoad=!0;var t=[];t=4==this.activeIndex?[-1]:3==this.activeIndex?[3,-2]:2==this.activeIndex?[1,2]:1==this.activeIndex?[0]:[0,1,2,3,-1,-2],this.getMeetingDetail(t,2,0)},onPullDownRefresh:function(){var t=this;this.pageObj.creatMeetingList=[],t.setData({pullDownNumber:0});var e=[];e=4==this.activeIndex?[-1]:3==this.activeIndex?[3,-2]:2==this.activeIndex?[1,2]:1==this.activeIndex?[0]:[0,1,2,3,-1,-2],this.getMeetingDetail(e,2,0)},onUnload:function(){wx.hideToast()},methods:{tapClick:function(t,e){this[t](e)},bindClickTabs:function(t){this.setData({nomore:!1});var e=t.detail.activeIndex;this.pageObj.creatMeetingList=[],this.pullDownNumber=0,this.attanceCount=0,this.isCanLoad=!0,this.setData({pullDownNumber:0,activeIndex:e}),this.dealStatusByActiveIndex(e,2,0)},dealStatusByActiveIndex:function(t,e,i){var a=[];0==t?a=[0,1,2,3,-1,-2]:1==t?a=[0]:2==t?a=[1,2]:3==t?a=[3,-2]:4==t&&(a=[-1]),this.getMeetingDetail(a,e,i)},getMeetingDetail:function(t,e,i){l.globalData.ShowMsgUtil.showLoadAndMsgToast();var a=this;l.globalData.ShowMsgUtil.netErrNotice();var n=l.globalData.StorageUtil.get("userInfoCach");wx.request({url:l.globalData.RequestUrl.appointmentRequestUrl.listByStatus+"?meetingStatus="+t+"&userRole=1&take="+e+"&skip="+i,method:"GET",header:{token:n.token},success:function(t){console.log("获取会议列表返回",t.data),t.data&&200==t.data.code?(a.dealPageObj(t.data.rows),a.setData({nomore:!1}),t.data.rows.length!=a.attanceCount?(a.pullDownNumber++,a.attanceCount=t.data.rows.length,a.isCanLoad=!0):(console.log("没有数据更新"),a.setData({isCanLoad:!1,nomore:!0}),console.log(a.nomore))):l.globalData.ShowMsgUtil.showErrorModal("请求失败",t.data.msg,t.data.code)},fail:function(){l.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideToast({}),uni.stopPullDownRefresh()}})},dealPageObj:function(t){var e=this.dealCreatMeeting(t);this.pageObj.creatMeetingList=e,console.log("页面数据-",this.pageObj),this.setData({pageObj:this.pageObj})},dealCreatMeeting:function(t){for(var e=this.meetingType,i=[],a=0;a<t.length;a++){var n={},o=t[a].meetingType-1;n.meetingId=t[a].meetingId,n.meetingSubject=t[a].meetingSubject,n.meetingRoomName=t[a].meetingRoomName,n.meetingType=e[o],n.meetingStartTime=l.globalData.PublicUtil.formatTimeTwo(t[a].meetingStartTime,"Y-M-D h:m"),n.meetingInitiator=t[a].meetingInitiator,n.createTime=t[a].createTime,n.meetingStatus=t[a].meetingStatus;var s=t[a].meetingStatus;if(-1==s)n.statusName="审核不通过",n.statusImage=c.unapprovePic,n.btn=[{name:"删除会议",bindtap:"deleteMeeting"},{name:"重新发起",bindtap:"createMeeting"}];else if(0==s)n.statusName="待审核",n.statusImage=c.checkPendingPic,n.btn=[{name:"取消会议",bindtap:"cancelMeeting"},{name:"编辑会议",bindtap:"editMeeting"}];else if(1==s)n.statusName="未开始",n.statusImage=c.nostartPic,n.btn=[{name:"取消会议",bindtap:"cancelMeeting"},{name:"开始签到",bindtap:"signIn"}];else if(2==s){n.statusName="进行中",n.statusImage=c.readyStartingPic;var r=(new Date).getTime();n.btn=[{name:"取消会议",bindtap:"cancelMeeting"},{name:"开始签到",bindtap:"signIn"}],console.log(r>=t[a].meetingStartTime),r>=t[a].meetingStartTime&&(n.btn=[{name:"开始签到",bindtap:"signIn"}])}else-2==s?(n.statusName="已过期",n.statusImage=c.meetingOutPic):(n.statusName="审核通过",n.statusImage=c.approvePic,3==s?(n.statusName="已结束",n.btn=[{name:"删除会议",bindtap:"deleteMeeting"},{name:"查看统计",bindtap:"viewStatistics"}]):(console.log("未完成的会议---------------"),n.btn=[{name:"取消会议",bindtap:"cancelMeeting"},{name:"开始签到",bindtap:"signIn"}]));n.meetingAttendee="";for(var g=0;g<t[a].meetingAttendee.length;g++)g==t[a].meetingAttendee.length-1?n.meetingAttendee=n.meetingAttendee+t[a].meetingAttendee[g].userName:n.meetingAttendee=n.meetingAttendee+t[a].meetingAttendee[g].userName+"、";i[a]=n}return i},toDetail:function(t){l.globalData.PublicUtil.navigateByUrl(l.globalData.PageUrl.appointmentPageUrl.meetingDetailUrl+"?meetingId="+t.id,500)},cancelMeeting:function(t){var e=t.id,i=this,a=l.globalData.StorageUtil.get("userInfoCach");wx.showModal({title:"提示",content:"是否取消预约信息",cancelText:"否",confirmText:"是",confirmColor:"#20a4f7",success:function(t){t.confirm?(l.globalData.ShowMsgUtil.showLoadToast("正在取消..."),l.globalData.ShowMsgUtil.netErrNotice(),wx.request({url:l.globalData.RequestUrl.appointmentRequestUrl.cancelMeeting+"?meetingId="+e,method:"POST",header:{token:a.token},data:{},success:function(t){console.log("取消会议返回",t.data),t.data&&200==t.data.code?(console.log("已取消该会议,刷新页面"),l.globalData.ShowMsgUtil.showSuccessToast("取消成功",2e3),i.reflesh(i)):l.globalData.ShowMsgUtil.showErrorModal("取消失败",t.data.msg,t.data.code)},fail:function(){l.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideToast({})}})):t.cancel}})},editMeeting:function(t){wx.showModal({title:"提示",content:"是否编辑预约信息",cancelText:"否",confirmText:"是",confirmColor:"#20a4f7",success:function(e){if(e.confirm)l.globalData.ShowMsgUtil.showLoadToast("正在跳转...",500),l.globalData.PublicUtil.navigateByUrl(l.globalData.PageUrl.appointmentPageUrl.meetingOperationUrl+"?meetingId="+t.id,500);else if(e.cancel)return}})},createMeeting:function(t){console.log("重新创建会议");var e=t.id;l.globalData.ShowMsgUtil.showLoadToast("正在跳转...",500),l.globalData.PublicUtil.navigateByUrl(l.globalData.PageUrl.appointmentPageUrl.meetingOperationUrl+"?meetingId="+e+"&isAgainApply=1",500)},deleteMeeting:function(t){var e=t.id;console.log(e);var i=this;wx.showModal({title:"提示",content:"是否删除预约信息",cancelText:"再想想",confirmText:"删除",confirmColor:"#20a4f7",success:function(t){if(t.confirm){var a=l.globalData.StorageUtil.get("userInfoCach");wx.request({url:l.globalData.RequestUrl.appointmentRequestUrl.cancelMeeting+"?meetingId="+e,method:"POST",header:{token:a.token},data:{},success:function(t){console.log("删除会议返回",t.data),t.data&&200==t.data.code?(console.log("已取删除会议,刷新页面"),l.globalData.ShowMsgUtil.showSuccessToast("删除成功",2e3),i.reflesh(i)):l.globalData.ShowMsgUtil.showErrorModal("删除失败",t.data.msg,t.data.code)},fail:function(){l.globalData.ShowMsgUtil.showNoneToastByFail()}})}else t.cancel}})},reflesh:function(t){var e=t,i=[];i=4==e.activeIndex?[-1]:3==e.activeIndex?[3,-3]:2==e.activeIndex?[1,2]:1==e.activeIndex?[0]:[0,1,2,3,-1,-3],e.getMeetingDetail(i,2,0)},viewStatistics:function(t){console.log(t),l.globalData.ShowMsgUtil.showLoadToast("正在跳转...",500),l.globalData.PublicUtil.navigateByUrl(l.globalData.PageUrl.appointmentPageUrl.attendaceStatisticsUrl+"?meetingId="+t.id,500)},signIn:function(){l.globalData.ShowMsgUtil.showLoadToast("正在跳转...",500),l.globalData.PublicUtil.navigateByUrl(l.globalData.PageUrl.appointmentPageUrl.attendAttendaceSignUrl,500)},lower:function(){var t=this,e=[];e=4==t.activeIndex?[-1]:3==t.activeIndex?[3,-2]:2==t.activeIndex?[1,2]:1==t.activeIndex?[0]:[0,1,2,3,-1,-2],this.isCanLoad&&(l.globalData.ShowMsgUtil.showLoadAndMsgToast(),console.log(this.pullDownNumber),this.getMeetingDetail(e,2*(this.pullDownNumber+1),0),console.log(this.pullDownNumber))},scroll:function(t){}}};e.default=s},b013:function(t,e,i){"use strict";i.r(e);var a=i("0c6e"),n=i("9e94");for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);i("4d77");var l,c=i("f0c5"),s=Object(c["a"])(n["default"],a["b"],a["c"],!1,null,"450c5c02",null,!1,a["a"],l);e["default"]=s.exports}}]);