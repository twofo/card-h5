(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-mineModule-pages-userDetail-userDetail"],{"0ca1":function(t,e,a){"use strict";a.r(e);var o=a("4249"),i=a.n(o);for(var s in o)"default"!==s&&function(t){a.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},1621:function(t,e,a){"use strict";var o;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"toastCover",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeCoverFun.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"toastCont",style:"max-height:"+t.maxHeight+"rpx; margin-top:"+t.marginTop+"rpx",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.defaultCover.apply(void 0,arguments)}}},[a("v-uni-view",{staticStyle:{overflow:"hidden"}},[t._t("default")],2)],1)],1)},s=[]},4249:function(t,e,a){"use strict";var o=a("4ea4");a("4d63"),a("ac1f"),a("25f0"),a("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(a("b1f8")),s=o(a("32e2")),n=o(a("77df")),l=o(a("0e2d")),r=a("9be7"),c=getApp(),d={data:function(){return{userInfoCach:{},userDetailCach:{},uploadPic:"",pic:"",tempFilePaths:[],imageBase64:"",imagesToApp:c.globalData.ImageUrl,imagesToMy:r,Imgcount:"",showToast:!1,showNotice:!1,showImgCount:!0,imgBg:r.bgColorImg}},components:{userDetailList:s.default,toastCover:n.default,avatar:l.default},onLoad:function(t){console.log("------------------------用户详情------------------------"),console.log(t);var e=this,a=t.pic;a?e.setData({uploadPic:a}):e.getImage(),e.getUserDetail()},onShow:function(){var t=this;try{var e=c.globalData.StorageUtil.get("userInfoCach");t.setData({userInfoCach:e});var a=!0;if(null!=e.role)a=!1;this.setData({showImgCount:a});var o=c.globalData.StorageUtil.get("userDetailCach"),s=c.globalData.StorageUtil.get("loginObjCach"),n=null==s.imgCount?"":s.imgCount;o||((0,i.default)("userDetailCach"),o={}),t.setData({userDetailCach:o,Imgcount:n})}catch(l){}},methods:{showToastFun:function(){this.setData({showToast:!0})},closeToast:function(){this.setData({showToast:!1})},closeCover:function(t){console.log(t),this.setData({showNotice:t.detail.closeCover})},closeCoverface:function(t){this.setData({showToast:t.detail.closeCover})},getUserDetail:function(){var t=this;c.globalData.ShowMsgUtil.netErrNotice();var e=c.globalData.StorageUtil.get("userInfoCach");wx.request({url:c.globalData.RequestUrl.baseRequestUrl.getUserDetail,data:{},header:{token:e.token,"content-type":"application/json"},method:"POST",success:function(a){if(console.log("用户详情返回",a.data),a.data&&200==a.data.code){var o=c.globalData.PublicUtil.isNullDeal(e,a.data.rows);t.setData({userDetailCach:o}),c.globalData.StorageUtil.set("userDetailCach",o)}else c.globalData.ShowMsgUtil.showErrorModal("请求失败",a.data.msg,a.data.code)},fail:function(){c.globalData.ShowMsgUtil.showNoneToastByFail()}})},myUpload:function(t){console.log(t);var e=t.path,a=this,o="",i=c.globalData.base64Util.pathToBase64;i(e).then((function(t){o=t;var e=new RegExp("data:image/png;base64,","g"),i=o.replace(e,"");a.getImgUrl(i)})).catch((function(t){console.error(t)}))},getImgUrl:function(t){c.globalData.ShowMsgUtil.netErrNotice();var e=this,a=c.globalData.StorageUtil.get("userInfoCach");wx.request({url:c.globalData.RequestUrl.baseRequestUrl.upImage,data:{imageBase64:t},header:{token:a.token,"content-type":"application/json"},method:"POST",success:function(t){if(console.log("图片上传",t.data),!t.data||"200"!=t.data.code)return e.getImage(),void c.globalData.ShowMsgUtil.showErrorModal(t.data.msg,"人脸照片不清晰,请重新上传！",2e3);e.getImage(),c.globalData.ShowMsgUtil.showSuccessToast("上传成功！",2e3)},fail:function(t){c.globalData.ShowMsgUtil.showNoneToastByFail()}})},upImage:function(t){var e=this;c.globalData.ShowMsgUtil.netErrNotice();var a=c.globalData.StorageUtil.get("userInfoCach");if(t){wx.getFileSystemManager().readFile({filePath:t,encoding:"base64",success:function(t){e.setData({imageBase64:t.data}),console.log("图像 - ",t.data),wx.request({url:c.globalData.RequestUrl.baseRequestUrl.upImage,data:{imageBase64:t.data},header:{token:a.token,"content-type":"application/json"},method:"POST",success:function(t){if(console.log("图片上传",t.data),!t.data||"200"!=t.data.code)return e.getImage(),void c.globalData.ShowMsgUtil.showErrorModal(t.data.msg,"人脸照片不清晰,请重新上传！",2e3);e.getImage(),c.globalData.ShowMsgUtil.showSuccessToast("上传成功！",2e3)},fail:function(t){c.globalData.ShowMsgUtil.showNoneToastByFail()}})}})}},getImage:function(t){var e=this;c.globalData.ShowMsgUtil.netErrNotice();var a=c.globalData.StorageUtil.get("userInfoCach");wx.request({url:c.globalData.RequestUrl.baseRequestUrl.getImage,header:{token:a.token},method:"GET",success:function(t){if(console.log("获取头像",t.data),t.data&&200===t.data.code){e.setData({pic:t.data.rows.url,Imgcount:t.data.rows.imageUploadTimes});var a=c.globalData.StorageUtil.get("loginObjCach");a.image=t.data.rows.url,a.imgCount=t.data.rows.imageUploadTimes,c.globalData.StorageUtil.set("loginObjCach",a)}else{e.setData({Imgcount:t.data.rows.imageUploadTimes});var o=c.globalData.StorageUtil.get("loginObjCach");o.imgCount=t.data.rows.imageUploadTimes,c.globalData.StorageUtil.set("loginObjCach",o)}},fail:function(){c.globalData.ShowMsgUtil.showNoneToastByFail()}})},chooseImage:function(t){if(this.pic){var e=this;uni.showModal({title:"提示",content:"请确认是否删除头像",success:function(t){t.confirm?(console.log("用户点击确定"),e.deleteImage()):t.cancel&&console.log("用户点击取消")}})}},deleteImage:function(){c.globalData.ShowMsgUtil.netErrNotice(),c.globalData.ShowMsgUtil.showLoadToast("正在处理...");var t=this,e=c.globalData.StorageUtil.get("userInfoCach");wx.request({url:c.globalData.RequestUrl.baseRequestUrl.deleteImage,header:{token:e.token,"content-type":"application/json"},method:"POST",success:function(e){console.log("删除用户图片",e.data),e.data&&"200"==e.data.code?(c.globalData.ShowMsgUtil.showSuccessToast("图像删除成功！",2e3),t.getImage()):c.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(t){c.ShowMsgUtil.showNoneToastByFail()}})},error:function(t){console.log(t.detail)}}};e.default=d},"45fd":function(t,e,a){"use strict";a.r(e);var o=a("c85a"),i=a.n(o);for(var s in o)"default"!==s&&function(t){a.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},"55c3":function(t,e,a){"use strict";var o=a("86fc"),i=a.n(o);i.a},"5d55":function(t,e,a){var o=a("24fb");e=o(!1),e.push([t.i,"/* components/common/toastCover/toastCover.wxss */.toastCover[data-v-72cd8060]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;z-index:99999;overflow:hidden;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.toastCont[data-v-72cd8060]{width:75%;overflow:scroll;background:#fff;border-radius:%?22?%;padding:%?0?% %?50?% %?0?% %?50?%;box-sizing:border-box;border-bottom:%?60?% solid #fff;border-top:%?42?% solid #fff}",""]),t.exports=e},"68f9":function(t,e,a){"use strict";var o=a("9439"),i=a.n(o);i.a},"6cf5":function(t,e,a){"use strict";var o;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"page page_view"},[a("v-uni-view",{staticClass:"page__bd"},[a("v-uni-view",{staticClass:"reporter-pic "},[a("v-uni-text",{staticClass:"reporter-title"},[t._v("头像")]),t.showImgCount?a("v-uni-view",{staticClass:"repairImgCount"}):t._e(),null!=t.userInfoCach.role?a("v-uni-view",{staticClass:"btn-open",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}},[t.pic?a("v-uni-image",{staticClass:"user-avatar",attrs:{src:t.pic}}):a("v-uni-image",{staticClass:"user-avatar",attrs:{src:t.imagesToApp.admin1}}),a("v-uni-image",{staticClass:"btn-enter",attrs:{src:t.imagesToMy.enter}})],1):a("v-uni-view",{staticClass:"btn-open",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}},[t.pic?a("v-uni-view",{staticClass:"btn-open"},[a("v-uni-image",{staticClass:"user-avatar",attrs:{src:t.pic}}),a("v-uni-image",{staticClass:"btn-enter",attrs:{src:t.imagesToMy.enter}})],1):a("v-uni-view",{staticClass:"btn-open"},[a("v-uni-image",{staticClass:"user-avatar",attrs:{src:t.imagesToApp.admin1}}),a("v-uni-image",{staticClass:"btn-enter",attrs:{src:t.imagesToMy.enter}})],1)],1)],1)],1),a("v-uni-view",{staticClass:"page__bd"},[a("user-detail-list",{attrs:{userDetailCach:t.userDetailCach,userInfoCach:t.userInfoCach,isUserDetail:1}})],1),t.showNotice?a("toast-cover",{staticClass:"faceNotice",attrs:{maxHeight:"290"},on:{closeCover:function(e){arguments[0]=e=t.$handleEvent(e),t.closeCover.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"toastCover-head noticeFont"},[t._v("温馨提示")]),a("v-uni-view",{staticClass:"faceNoticeTxt faceTxt nomoreTimes"},[a("v-uni-text",[t._v("您的更改次数已用完！")])],1)],1):t._e(),t.showToast?a("toast-cover",{staticClass:"faceNotice",attrs:{maxHeight:"850"},on:{closeCover:function(e){arguments[0]=e=t.$handleEvent(e),t.closeCoverface.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"toastCover-head noticeFont"},[t._v("“人脸”说明")]),a("v-uni-view",{staticClass:"faceToastCont"},[a("v-uni-view",{staticClass:"faceTxt"},[t._v("“人脸”功能是将用户的真人照片与现场拍摄照片进行比对验证。其功能目的是帮助校内工作人员提高效率，并给校内师生们带来更多便利。在使用过程中，请注意以下：")]),a("v-uni-view",{staticClass:"faceImgBox"},[a("v-uni-image",{staticClass:"faceImg",attrs:{src:t.imagesToMy.faceImg,mode:"widthFix"}}),a("v-uni-view",{staticClass:"noticeFont"},[t._v("VS")]),a("v-uni-image",{staticClass:"faceImg",attrs:{src:t.imagesToMy.xcImg,mode:"widthFix"}}),a("v-uni-image",{staticClass:"faceImg",attrs:{src:t.imagesToMy.compareImg,mode:"widthFix"}})],1),a("v-uni-view",{staticClass:"faceNoticeTxt faceTxt"},[a("v-uni-text",[t._v("1.请务必上传本人照片。")]),a("v-uni-text",[t._v("2.考虑到安全性，人脸照片只允许更改2次(第一次添加照片除外),请谨慎更改。")])],1),a("v-uni-view",{staticClass:"closeToast noticeFont",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeToast.apply(void 0,arguments)}}},[t._v("确定")])],1)],1):t._e(),a("avatar",{ref:"avatar",attrs:{bgImage:t.imgBg,selWidth:"200px",selHeight:"200px",fileType:"png",avatarSrc:t.pic,quality:"1",inner:"true",avatarStyle:"width: 200px; height: 200px; margin: 40px;"},on:{upload:function(e){arguments[0]=e=t.$handleEvent(e),t.myUpload.apply(void 0,arguments)}}})],1)},s=[]},"6fe7":function(t,e,a){var o=a("24fb");e=o(!1),e.push([t.i,".reporter-pic[data-v-15824dc7]{background-color:#fff;margin-bottom:%?7?%;height:%?170?%;-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.reporter-title[data-v-15824dc7]{margin-left:%?35?%;font-size:14pt;-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.user-avatar[data-v-15824dc7]{width:%?120?%;height:%?120?%;border:%?1?% #ddd4d4 solid;border-radius:%?65?%;margin-right:%?55?%}.btn-open[data-v-15824dc7]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;margin-left:%?10?%}.btn-enter[data-v-15824dc7]{width:%?16?%;height:%?20?%;position:relative;right:%?30?%}.repairImgCount[data-v-15824dc7]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin-right:%?10?%}.noticeFont[data-v-15824dc7]{color:#ff2020}.repairImgCountText[data-v-15824dc7]{margin-left:%?10?%;font-size:%?28?%}.noticeFont[data-v-15824dc7]{color:#20a4f7}.toastCover-head[data-v-15824dc7]{text-align:center;font-size:%?36?%;letter-spacing:%?4?%;font-weight:700}.faceTxt[data-v-15824dc7]{font-size:%?28?%}.faceToastCont[data-v-15824dc7]{margin-top:%?28?%}.faceImg[data-v-15824dc7]{width:%?100?%}.faceImgBox[data-v-15824dc7]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin-top:%?20?%}.faceNoticeTxt[data-v-15824dc7]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:start;-webkit-align-items:flex-start;align-items:flex-start;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;margin-top:%?40?%}.closeToast[data-v-15824dc7]{width:100%;text-align:center;height:%?80?%;border-top:%?1?% solid #eee;margin-top:%?40?%;line-height:%?80?%;letter-spacing:%?8?%}.nomoreTimes[data-v-15824dc7]{-webkit-box-align:center;-webkit-align-items:center;align-items:center}.fontColorGray[data-v-15824dc7]{color:#7c7c7c}.fontColorRed[data-v-15824dc7]{color:#ff2020}",""]),t.exports=e},"77df":function(t,e,a){"use strict";a.r(e);var o=a("1621"),i=a("45fd");for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("55c3");var n,l=a("f0c5"),r=Object(l["a"])(i["default"],o["b"],o["c"],!1,null,"72cd8060",null,!1,o["a"],n);e["default"]=r.exports},"86fc":function(t,e,a){var o=a("5d55");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("4f06").default;i("d376ffba",o,!0,{sourceMap:!1,shadowMode:!1})},8950:function(t,e,a){"use strict";a.r(e);var o=a("6cf5"),i=a("0ca1");for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);a("68f9");var n,l=a("f0c5"),r=Object(l["a"])(i["default"],o["b"],o["c"],!1,null,"15824dc7",null,!1,o["a"],n);e["default"]=r.exports},9439:function(t,e,a){var o=a("6fe7");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("4f06").default;i("4370781f",o,!0,{sourceMap:!1,shadowMode:!1})},b1f8:function(t,e,a){"use strict";function o(t){throw new Error('"'+t+'" is read-only')}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},c85a:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{closeCover:!0}},components:{},props:{maxHeight:{type:String,default:"934"},marginTop:{type:String,default:"0"}},methods:{closeCoverFun:function(){var t=this.closeCover;t=!t;var e={closeCover:t};this.setData({closeCover:t}),this.$emit("closeCover",{detail:e})},defaultCover:function(){var t=this.closeCover,e={closeCover:!0};this.setData({closeCover:t}),this.$emit("closeCover",{detail:e})}}};e.default=o}}]);