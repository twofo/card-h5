(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repairModule-pages-repairDetailOfMaintain-repairDetailOfMaintain"],{"0636":function(a,e,t){"use strict";var i=t("e577"),n=t.n(i);n.a},"16b1":function(a,e,t){"use strict";var i;t.d(e,"b",(function(){return n})),t.d(e,"c",(function(){return o})),t.d(e,"a",(function(){return i}));var n=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("v-uni-view",{staticClass:"page"},[t("v-uni-view",{staticClass:"page__bd"},[t("v-uni-view",[t("repair-detail",{attrs:{pageObj:a.pageObj,callImage:a.callImage},on:{call:function(e){arguments[0]=e=a.$handleEvent(e),a.bindCallPhone.apply(void 0,arguments)}}}),a.btnObj.isRefuse?""!=a.btnObj.isRefuse&&a.btnObj.isRefuse?t("v-uni-view",{staticClass:"weui-cells weui-cells_after-title",staticStyle:{"margin-top":"10rpx"}},[t("v-uni-view",{staticClass:"weui-cell"},[t("v-uni-view",{staticClass:"weui-cell__bd"},[t("v-uni-textarea",{staticClass:"weui-textarea",staticStyle:{height:"3.6em"},attrs:{placeholder:"请填写拒绝原因",maxlength:"200"},on:{input:function(e){arguments[0]=e=a.$handleEvent(e),a.inputReasonFun.apply(void 0,arguments)}}}),t("v-uni-view",{staticClass:"weui-textarea-counter"},[a._v(a._s(a.cursor)+"/200")])],1)],1)],1):a._e():t("v-uni-view",{staticClass:"weui-cell weui-cell_access",staticStyle:{"background-color":"#fff","margin-top":"10rpx"},attrs:{"hover-class":"weui-cell_active"}},[t("v-uni-view",{staticClass:"weui-cell__bd"},[a._v("约定维修时间")]),t("v-uni-view",{staticClass:"weui-cell__ft weui-cell__ft_in-access"},[t("v-uni-picker",{attrs:{mode:"date",value:a.date,start:a.startTime,end:"2030-09-01",disabled:a.aaa},on:{change:function(e){arguments[0]=e=a.$handleEvent(e),a.bindDateChange.apply(void 0,arguments)}}},[t("v-uni-view",[a._v(a._s(a.date))])],1)],1)],1),a.btnObj.isFinish?t("v-uni-view",{staticClass:"weui-cells",staticStyle:{"font-size":"15px"}},[t("v-uni-view",{staticClass:"weui-cell"})],1):a._e(),5!==a.pageObj.repairStatus&&4!==a.pageObj.repairStatus?t("v-uni-view",{staticClass:"page__bd page__bd_spacing button_top"},["confirmFinish"==a.btnObj.bind&&0!==a.personType?t("v-uni-view",{},[t("v-uni-button",{staticClass:"weui-btn",attrs:{type:"primary",disabled:a.disabled,"form-type":"submit"},on:{click:function(e){arguments[0]=e=a.$handleEvent(e),a.confirmFinish.apply(void 0,arguments)}}},[a._v(a._s(a.btnObj.name))])],1):a._e(),"confirmRefuse"==a.btnObj.bind&&0!==a.personType?t("v-uni-view",{},[t("v-uni-button",{staticClass:"weui-btn",attrs:{type:"primary",disabled:a.disabled,"form-type":"submit"},on:{click:function(e){arguments[0]=e=a.$handleEvent(e),a.confirmRefuse.apply(void 0,arguments)}}},[a._v(a._s(a.btnObj.name))])],1):a._e(),"confirmDeal"==a.btnObj.bind&&0!==a.personType?t("v-uni-view",{},[t("v-uni-button",{staticClass:"weui-btn",attrs:{type:"primary",disabled:a.disabled,"form-type":"submit"},on:{click:function(e){arguments[0]=e=a.$handleEvent(e),a.confirmDeal.apply(void 0,arguments)}}},[a._v(a._s(a.btnObj.name))])],1):a._e()],1):a._e()],1)],1)],1)},o=[]},"5c1d":function(a,e,t){"use strict";t.r(e);var i=t("cd19"),n=t.n(i);for(var o in i)"default"!==o&&function(a){t.d(e,a,(function(){return i[a]}))}(o);e["default"]=n.a},"5c71":function(a,e,t){var i=t("24fb");e=i(!1),e.push([a.i,'.myui__box[data-v-2bff858e]{padding:%?10?% %?20?%}.myui-bd__ft[data-v-2bff858e]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.myui-cell-image[data-v-2bff858e]{width:%?50?%;height:%?50?%}\r\n/* 图片 */.text-date[data-v-2bff858e]{padding:%?20?% %?30?% %?10?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background:#fff}.img[data-v-2bff858e]{width:%?120?%;height:%?120?%;margin-right:%?30?%}\r\n/* 按钮 */uni-button[type="primary"][data-v-2bff858e]{background-color:#20a4f7}.myui__btn-top[data-v-2bff858e]{margin-top:%?30?%}',""]),a.exports=e},8274:function(a,e,t){"use strict";t.r(e);var i=t("16b1"),n=t("5c1d");for(var o in n)"default"!==o&&function(a){t.d(e,a,(function(){return n[a]}))}(o);t("0636");var r,s=t("f0c5"),l=Object(s["a"])(n["default"],i["b"],i["c"],!1,null,"2bff858e",null,!1,i["a"],r);e["default"]=l.exports},c2d6:function(a,e){var t="/static/pages/repairModule/resources/pic",i={image:t,repairApplyPic:"".concat(t,"/repair_apply.png"),myRepairPic:"".concat(t,"/repair_my.png"),starOn:"".concat(t,"/star_on.png"),starOff:"".concat(t,"/star_off.png"),icCall:"".concat(t,"/ic_call.png"),icProcessBlue:"".concat(t,"/ic_process_blue.png"),icProcessGray:"".concat(t,"/ic_process_gray.png"),navHomePage:"".concat(t,"/nav_home_page.png"),navHomePagePressed:"".concat(t,"/nav_home_page_pressed.png"),navMine:"".concat(t,"/nav_mine.png"),navMinePressed:"".concat(t,"/nav_mine_pressed.png"),navWorkerOrder:"".concat(t,"/nav_worker_order.png"),navWorkerOrderPressed:"".concat(t,"/nav_worker_order_pressed.png"),navNew:"".concat(t,"/nav_new.png"),navNewPressed:"".concat(t,"/nav_new_pressed.png"),bgRepairHeader:"".concat(t,"/bg_repair_header.png"),mineFunRecord:"".concat(t,"/mine_fun_record.png"),icStars:"".concat(t,"/ic_stars.png"),icTypeOther:"".concat(t,"/ic_type_other.png"),icRepairLock:"".concat(t,"/ic_repair_lock.png"),icRepairAmmeter:"".concat(t,"/ic_repair_ammeter.png"),icRepairWatermeter:"".concat(t,"/ic_repair_watermeter.png"),icRepairLamp:"".concat(t,"/ic_repair_lamp.png"),icClose:"".concat(t,"/close.png")};a.exports=i},cd19:function(a,e,t){"use strict";var i=t("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(t("3fb6")),o=getApp(),r=t("ddc5"),s=t("c2d6"),l={data:function(){return{pageObj:{},callImage:s.icCall,repairCode:"",startTime:"",date:"",btnObj:{},inputReason:"",cursor:0,disabled:!1,aaa:!1,personType:""}},components:{repairDetail:n.default},props:{},onLoad:function(a){console.log("------------------------报修详情------------------------"),console.log("选中报修单号",a.repairCode);var e=o.globalData.StorageUtil.get("userInfoCach");console.log(e),this.setData({personType:e.personType});var t={};"true"===a.isRefuse?(t.isRefuse=!0,t.name="确认拒绝",t.bind="confirmRefuse"):(t.isRefuse=!1,t.name="确认处理",t.bind="confirmDeal"),console.log("obj",""!=t.isRefuse);var i=o.globalData.PublicUtil.formatTimeTwo(new Date,"Y-M-D");this.setData({date:i,startTime:i,repairCode:a.repairCode}),this.selectRepairByCode(a.repairCode,t)},methods:{selectRepairByCode:function(a,e){var t=this;o.globalData.ShowMsgUtil.netErrNotice();var i=o.globalData.StorageUtil.get("userInfoCach");wx.request({url:o.globalData.RequestUrl.repairRequestUrl.selectRepairByCode+"?repairCode="+a,method:"GET",header:{token:i.token},success:function(a){if(console.log("查询报修详情返回",a.data),a.data&&200==a.data.code){var i=a.data.rows;4!=i.repairStatus&&5!=i.repairStatus||t.setData({aaa:!0}),i=t.dealShow(i,e),t.setData({pageObj:i})}else o.globalData.ShowMsgUtil.showErrorModal("请求失败",a.data.msg,a.data.code)},fail:function(){o.globalData.ShowMsgUtil.showNoneToastByFail()}})},dealShow:function(a,e){a.deviceName=r.deviceType(a.deviceTypeId),a.statusName=r.status(a.repairStatus);var t=a.repairStatus,i={isCall:!0,bindtap:"toCall"};return 3==t?(e.name="确认完成",e.bind="confirmFinish",console.log(e)):4==t&&(e.isFinish=!0),this.setData({btnObj:e}),console.log(this.btnObj.bind),a.callObj=i,a},bindCallPhone:function(a){var e=a.detail.phone;this.callPhone(e)},toCall:function(a){var e=a.currentTarget.dataset.phone;this.callPhone(e)},callPhone:function(a){wx.showModal({title:"呼叫",content:"拨打"+a,success:function(e){e.confirm?wx.makePhoneCall({phoneNumber:a}):e.cancel&&console.log("用户点击取消")}})},bindDateChange:function(a){this.setData({date:a.detail.value})},confirmDeal:function(){var a=this;o.globalData.ShowMsgUtil.netErrNotice();var e=o.globalData.StorageUtil.get("userInfoCach");return""==a.repairCode?(o.globalData.ShowMsgUtil.showErrorModal("请求失败","该报修订单不存在！"),void a.setData({disabled:!1})):""==a.date?(o.globalData.ShowMsgUtil.showErrorModal("请求失败","约定维修时间不能为空！"),void a.setData({disabled:!1})):(a.setData({disabled:!0}),o.globalData.ShowMsgUtil.showLoadToast("正在处理..."),void wx.request({url:o.globalData.RequestUrl.repairRequestUrl.confirmDeal,data:{repairCode:a.repairCode,maintainTime:a.date},method:"POST",header:{token:e.token,"content-type":"application/json"},success:function(e){if(console.log("确认处理返回",e.data),!e.data||200!=e.data.code)return a.setData({disabled:!1}),void o.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code);o.globalData.ShowMsgUtil.showSuccessToast("确认处理成功",2e3),o.globalData.StorageUtil.set("tabBarIndex",1),o.globalData.PublicUtil.navigateByUrl(o.globalData.PageUrl.repairPageUrl.index,2e3)},fail:function(){a.setData({disabled:!1}),o.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideToast()}}))},confirmRefuse:function(){var a=this;o.globalData.ShowMsgUtil.netErrNotice();var e=o.globalData.StorageUtil.get("userInfoCach");if(""==a.inputReason)return o.globalData.ShowMsgUtil.showErrorModal("请求失败","拒绝原因不能为空！"),void a.setData({disabled:!1});a.setData({disabled:!0}),o.globalData.ShowMsgUtil.showLoadToast("正在申请..."),wx.request({url:o.globalData.RequestUrl.repairRequestUrl.confirmRefuse,data:{repairCode:a.repairCode,repairRemarks:a.inputReason},method:"POST",header:{token:e.token,"content-type":"application/json"},success:function(a){console.log("确认拒绝返回",a.data),a.data&&200==a.data.code?(o.globalData.ShowMsgUtil.showSuccessToast("确认拒绝成功",2e3),o.globalData.StorageUtil.set("tabBarIndex",1),o.globalData.PublicUtil.reLaunchByUrl(o.globalData.PageUrl.repairPageUrl.index,2e3)):o.globalData.ShowMsgUtil.showErrorModal("请求失败",a.data.msg,a.data.code)},fail:function(){o.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideToast()}})},inputReasonFun:function(a){this.setData({cursor:a.detail.cursor,inputReason:a.detail.value})},confirmFinish:function(a){console.log(a);var e=this.repairCode;o.globalData.PublicUtil.navigateByUrl(o.globalData.PageUrl.repairPageUrl.maintainFinishUrl+"?repairCode="+e,500)},handleClick:function(){console.log(a),console.log(this.$data.btnObj.bind);var a=this.$data.btnObj.bind,e="confirmFinish",t="confirmRefuse",i="confirmDeal";a==e&&(console.log(1111111),this.confirmFinish()),a==t&&this.confirmRefuse(),a==i&&this.confirmDeal()}}};e.default=l},ddc5:function(a,e){getApp().globalData;function t(a){var e="";return 0==a?e="其它":1==a?e="门锁":2==a?e="水表":3==a?e="消费机":4==a?e="电表":5==a&&(e="空调电表"),e}function i(a){var e="";return 1==a?e="待分配":2==a?e="待接单":3==a?e="处理中":4==a?e="已完成":5==a?e="已评价":6==a&&(e="已拒绝"),e}a.exports={status:i,deviceType:t}},e577:function(a,e,t){var i=t("5c71");"string"===typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);var n=t("4f06").default;n("ff6c8336",i,!0,{sourceMap:!1,shadowMode:!1})}}]);