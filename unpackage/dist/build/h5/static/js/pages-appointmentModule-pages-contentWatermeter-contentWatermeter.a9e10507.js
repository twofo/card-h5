(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-appointmentModule-pages-contentWatermeter-contentWatermeter"],{"07fb":function(e,t,o){"use strict";var n=o("4ea4");o("c975"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(o("c783")),a=o("3350"),c=getApp(),s=(c.globalData.arrayBufferDemo,c.globalData.bluetoothUtil,c.globalData.agreementUtil,[]);var l={data:function(){return{ImageUrls:a,checked:!1,contBlueBase:{},searchBlueBase:[],startSearch:!1,showModel:!1,btnList:[],msg:"",deviceId:"",isGetBluetoothInfo:0,deviceName:""}},components:{msgSelect:i.default},props:{},onLoad:function(e){},onUnload:function(){console.log("生命周期函数--监听页面卸载"),this.stopBluetoothDevicesDiscovery(),this.stopsearch(),this.setData({searchBlueBase:[]})},methods:{goToContent:function(){s=[],this.initializeBluetooth()},initializeBluetooth:function(){var e=this;this.checked;wx.closeBluetoothAdapter({complete:function(t){console.log("关闭蓝牙模块 - ",t),wx.openBluetoothAdapter({success:function(t){console.log("初始化蓝牙设备 - ",t),e.setData({checked:!0}),wx.onBluetoothAdapterStateChange((function(t){console.log("蓝牙适配器状态变化 - ",t);var o=t.available?"蓝牙适配器可用":"蓝牙适配器不可用",n=t.discovering?"正在搜索":"搜索可用";console.log("手机蓝牙是否可用：",o),console.log("是否正在搜素",n);var i=t.available;i||(c.globalData.ShowMsgUtil.showErrorModal("蓝牙连接失败","手机蓝牙不可用："),e.stopBluetoothDevicesDiscovery(),e.setData({searchBlueBase:[]}))})),wx.onBluetoothDeviceFound((function(t){var o=0,n=[];console.log("监听寻找新设备的事件 - ",t.devices[0]);for(var i=0;i<t.devices.length;i++){if(!t.devices[i].deviceId||!t.devices[i].name)return;n[o++]=t.devices[i]}var a=t.devices[0];a.name.indexOf("#")>-1&&s.push(a),e.setData({searchBlueBase:s})}))},fail:function(t){c.globalData.ShowMsgUtil.showErrorModal("蓝牙连接失败","请检查手机蓝牙是否打开"),console.warn("请检查手机蓝牙是否打开"),e.setData({checked:!1})}})},fail:function(e){c.globalData.ShowMsgUtil.showErrorModal("蓝牙连接失败","请检查手机蓝牙是否打开"),console.warn("请检查手机蓝牙是否打开")}})},startBluetoothDevicesDiscovery:function(){if(console.log(">>>>>>>>>checked - ",this.checked),0!=this.checked){var e=this;c.globalData.ShowMsgUtil.showLoadToast("正在搜索设备",2e3),e.setData({startSearch:!0}),wx.startBluetoothDevicesDiscovery({success:function(e){}})}else c.globalData.ShowMsgUtil.showErrorModal("操作失败","请先打开蓝牙开关")},stopBluetoothDevicesDiscovery:function(){wx.stopBluetoothDevicesDiscovery(),this.setData({startSearch:!1})},stopsearch:function(){wx.stopBluetoothDevicesDiscovery({success:function(e){console.log("停止蓝牙搜索"),console.log(e)}})},toConnect:function(e){wx.hideToast(),console.log(">>>>>>>>>>>toConnect - ...",e);var t=["取消","连接"];this.setData({contBlueBase:e.currentTarget.dataset.value,msg:"是否连接",showModel:!0,btnList:t})},bindConfirm:function(){var e=this,t=this;console.log(">>>>>>>>>>>toConnect - res>",t.contBlueBase.deviceId),t.setData({showModel:!1}),c.globalData.ShowMsgUtil.showLoadAndMsgToast("连接水表中..."),wx.createBLEConnection({deviceId:t.contBlueBase.deviceId,timeout:3e4,success:function(e){if(console.log(">>>>>>>>>>>toConnect - res>",e),0==e.errCode){var o=t.contBlueBase.deviceId,n=50;setTimeout((function(){wx.setBLEMTU({deviceId:o,mtu:n,success:function(e){console.log("setBLEMTU:success:",e)},fail:function(e){console.error("setBLEMTU:fail:",e)}})}),1e3),c.globalData.StorageUtil.remove("connectDeviceInfo"),console.log(">>>>>>>>>>>toConnect - 连接水表: success"),t.setData({deviceId:t.contBlueBase.deviceId}),c.globalData.StorageUtil.set("connectDeviceInfo",t.contBlueBase.deviceId);var i=getCurrentPages(),a=i[i.length-2];a.setData({isGetBluetoothInfo:1,deviceName:t.contBlueBase.localName}),t.stopBluetoothDevicesDiscovery(),t.stopsearch(),c.globalData.PublicUtil.navigateBack(2e3)}else c.globalData.ShowMsgUtil.showErrorModal("提示","不能正常对水表进行连接")},fail:function(e){wx.hideLoading(),10012==e.errCode&&c.globalData.ShowMsgUtil.showErrorModal("提示","水表连接超时"),t.setData({checked:!1}),console.warn(">>>>>>>>>>>toConnect - 连接水表: fail",e)},complete:function(){e.setData({showModel:!1}),wx.hideLoading()}})},wxSetBLEMTU:function(){wx.setBLEMTU({deviceId:this.contBlueBase.deviceId,mtu:50,success:function(e){console.log("setBLEMTU:success:",e)},fail:function(e){console.error("setBLEMTU:fail:",e)},complete:function(e){console.log("setBLEMTU:complete:",e)}})},bindCancel:function(){this.setData({showModel:!1})}}};t.default=l},1605:function(e,t,o){var n=o("24fb");t=n(!1),t.push([e.i,".connectedSum[data-v-4a02de40]{padding:%?20?% %?30?% 0;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.searchBlueItem[data-v-4a02de40]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-content:center;align-content:center;font-size:%?28?%}.sendErr[data-v-4a02de40]{color:#f66c45}.noticeColor[data-v-4a02de40]{color:#ffc680}.loadingImg[data-v-4a02de40]{-webkit-animation:relation-data-v-4a02de40 1s linear infinite;animation:relation-data-v-4a02de40 1s linear infinite}@-webkit-keyframes relation-data-v-4a02de40{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes relation-data-v-4a02de40{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""]),e.exports=t},2296:function(e,t,o){var n=o("1605");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=o("4f06").default;i("61ee364c",n,!0,{sourceMap:!1,shadowMode:!1})},3350:function(e,t){var o="/static/pages/appointmentModule/resources/pic",n={image:o,optionAppointmentPic:"".concat(o,"/option_appointment.png"),optionAttendanceApprovePic:"".concat(o,"/option_attendance_approve.png"),optionMakeCardApplyPic:"".concat(o,"/option_make_card_apply.png"),meetingAttendanceListPic:"".concat(o,"/meeting_attendance_list.png"),meetingAttendanceSignInPic:"".concat(o,"/meeting_attendance_sign_in.png"),blueRecord:"".concat(o,"/blueRecord.png"),closeDefault:"".concat(o,"/closeDefault.png"),closeOpen:"".concat(o,"/closeOpen.png"),loadingPic:"".concat(o,"/loading.png"),checkPendingPic:"".concat(o,"/check_pending.png"),approvePic:"".concat(o,"/approve.png"),unapprovePic:"".concat(o,"/unapprove.png"),nostartPic:"".concat(o,"/nostart.png"),readyStartPic:"".concat(o,"/action.png"),submitCluePic:"".concat(o,"/submit_clue.png"),meetingRoomSmallPic:"".concat(o,"/meeting_room_small.png"),meetingRoomMiddlePic:"".concat(o,"/meeting_room_middle.png"),meetingRoomBigPic:"".concat(o,"/meeting_room_big.png"),meetingRoomFrobidPic:"".concat(o,"/meeting_room_frobid.png"),requiredPic:"".concat(o,"/required.png"),attendaceRightPic:"".concat(o,"/right.png"),attendaceErrorPic:"".concat(o,"/error.png"),readyStartingPic:"".concat(o,"/stating.png"),uploadImgPic:"".concat(o,"/Group.png"),blueSignPic:"".concat(o,"/blueSign.png"),changGuanAppiontPic:"".concat(o,"/PIM.png"),meetingRecordPic:"".concat(o,"/meetingRecord.png"),meetingRoomPic:"".concat(o,"/meetingRoom.png"),pianoRoomPic:"".concat(o,"/pianoRoom.png"),dancingPic:"".concat(o,"/dancing.png"),dancingListPic:"".concat(o,"/dancingList.png"),meetingOutPic:"".concat(o,"/meetinOut.png")};e.exports=n},3729:function(e,t,o){"use strict";var n=o("2296"),i=o.n(n);i.a},"4ca8":function(e,t,o){"use strict";var n;o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[e.showModel?o("v-uni-view",{staticClass:"modal-mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.hideModal.apply(void 0,arguments)}}}):e._e(),e.showModel?o("v-uni-view",{staticClass:"modal-dialog"},[o("v-uni-view",{staticClass:"modal-title myui-center"},[e._v(e._s(e.msg))]),o("v-uni-view",{staticClass:"myui-cell-bottom",staticStyle:{"font-size":"16px","margin-top":"10rpx"}},[o("v-uni-view",{staticClass:"myui-cell-bottom__bd myui-center",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancel.apply(void 0,arguments)}}},[e._v(e._s(e.btnList[0]))]),o("v-uni-view",{staticClass:"myui-cell-bottom__fd myui-center",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm.apply(void 0,arguments)}}},[e._v(e._s(e.btnList[1]))])],1)],1):e._e()],1)},a=[]},"51e8":function(e,t,o){"use strict";var n=o("f7e6"),i=o.n(n);i.a},"605d":function(e,t,o){"use strict";o.r(t);var n=o("07fb"),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a},6268:function(e,t,o){"use strict";var n;o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",{staticClass:"page"},[o("msg-select",{attrs:{msg:e.msg,showModel:e.showModel,btnList:e.btnList},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.bindConfirm.apply(void 0,arguments)},cancel:function(t){arguments[0]=t=e.$handleEvent(t),e.bindCancel.apply(void 0,arguments)}}}),o("v-uni-view",{staticClass:"weui-cells"},[o("v-uni-view",{staticClass:"weui-cell",staticStyle:{padding:"10rpx 30rpx",height:"30px"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.goToContent.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"weui-cell__bd more_bd"},[e._v("确认是否打开蓝牙")]),o("v-uni-view",{staticClass:"weui-cell__ft addBlue"},[o("v-uni-switch",{staticStyle:{zoom:"0.5"},attrs:{type:"switch",disabled:!0,checked:e.checked}})],1)],1)],1),o("v-uni-view",{staticClass:"searchBlue"},[o("v-uni-view",{staticClass:"weui-cells weui-cells_after-title",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.startBluetoothDevicesDiscovery.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"weui-cell weui-cell_access",attrs:{url:!0,"hover-class":"weui-cell_active"}},[o("v-uni-view",{staticClass:"weui-cell__hd"},[e.startSearch&&e.checked?o("v-uni-image",{staticClass:"loadingImg",staticStyle:{width:"20rpx"},attrs:{src:e.ImageUrls.loadingPic,mode:"widthFix"}}):e._e()],1),o("v-uni-view",{staticClass:"weui-cell__bd"},[e._v("附近可用设备")]),o("v-uni-view",{staticClass:"weui-cell__ft weui-cell__ft_in-access"},[e._v("点击搜索")])],1)],1),e.checked&&e.searchBlueBase.length>0?o("v-uni-view",{staticClass:"weui-cells"},[e._l(e.searchBlueBase,(function(t,n){return[o("v-uni-view",{key:n+"_0",staticClass:"weui-cell",staticStyle:{padding:"10rpx 30rpx",height:"30px"},attrs:{"data-value":t},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toConnect.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"weui-cell__bd more_bd"},[e._v("水表位置:"+e._s(t.name)+"[楼层#房间号]")]),o("v-uni-view",{staticClass:"weui-cell__ft searchBlueItem",attrs:{"data-value":t}},[o("v-uni-image",{staticStyle:{width:"30rpx","margin-right":"30rpx"},attrs:{src:e.ImageUrls.blueSignPic,mode:"widthFix"}}),t.RSSI+100>70?o("v-uni-view",[e._v("强")]):e._e(),69>t.RSSI+100>39?o("v-uni-view",{staticClass:"noticeColor"},[e._v("良")]):e._e(),t.RSSI+100<40?o("v-uni-view",{staticClass:"sendErr"},[e._v("弱")]):e._e()],1)],1)]}))],2):e._e()],1)],1)},a=[]},"6d37":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){return{}},components:{},props:{showModel:{type:Boolean,default:!1},msg:{type:String,default:"提示"},btnList:{type:Array,default:function(){return["取消","确认"]}}},methods:{confirm:function(){this.$emit("confirm")},cancel:function(){this.$emit("cancel")}}};t.default=n},"84ce":function(e,t,o){"use strict";o.r(t);var n=o("6268"),i=o("605d");for(var a in i)"default"!==a&&function(e){o.d(t,e,(function(){return i[e]}))}(a);o("3729");var c,s=o("f0c5"),l=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"4a02de40",null,!1,n["a"],c);t["default"]=l.exports},b8c5:function(e,t,o){var n=o("24fb");t=n(!1),t.push([e.i,'/* components/common/msgSelect/msgSelect.wxss */\r\n\r\n/* model弹窗 */.modal-mask[data-v-0beaf176]{width:100%;height:100%;position:fixed;top:0;left:0;background:#000;opacity:.3;overflow:hidden;z-index:9000;color:#fff}.modal-dialog[data-v-0beaf176]{width:%?540?%;overflow:hidden;position:fixed;top:50%;left:0;z-index:9999;background:#f9f9f9;margin:%?-180?% %?105?%;border-radius:%?20?%;padding:%?30?% %?20?% %?10?%}.modal-title[data-v-0beaf176]{padding:%?10?% %?20?% %?20?%;font-size:%?36?%;color:#030303}\r\n\r\n/* 按钮 */.myui-cell-bottom[data-v-0beaf176]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;color:#20a4f7;-webkit-align-content:center;align-content:center\r\n  /*align-items: center; */}.myui-cell-bottom[data-v-0beaf176]{padding:10px 15px;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.myui-cell-bottom[data-v-0beaf176]:before{content:" ";position:absolute;left:0;top:0;right:0;height:1px;border-top:%?1?% solid #e5e5e5;color:#d9d9d9;left:15px}.myui-cell-bottom[data-v-0beaf176]:first-child:before{display:none}.myui-cell-bottom__bd[data-v-0beaf176]{width:50%}.myui-cell-bottom__fd[data-v-0beaf176]{width:50%;border-left:%?3?% #20a4f7 solid}.myui-center[data-v-0beaf176]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}',""]),e.exports=t},c783:function(e,t,o){"use strict";o.r(t);var n=o("4ca8"),i=o("f827");for(var a in i)"default"!==a&&function(e){o.d(t,e,(function(){return i[e]}))}(a);o("51e8");var c,s=o("f0c5"),l=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"0beaf176",null,!1,n["a"],c);t["default"]=l.exports},f7e6:function(e,t,o){var n=o("b8c5");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=o("4f06").default;i("13806aa2",n,!0,{sourceMap:!1,shadowMode:!1})},f827:function(e,t,o){"use strict";o.r(t);var n=o("6d37"),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a}}]);