(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-attendanceModule-pages-studentReissueApply-studentReissueApply"],{"27d7":function(e,a,t){"use strict";t.r(a);var i=t("d789"),s=t.n(i);for(var n in i)"default"!==n&&function(e){t.d(a,e,(function(){return i[e]}))}(n);a["default"]=s.a},"4bbd":function(e,a,t){var i=t("24fb");a=i(!1),a.push([e.i,'.centerBackground[data-v-461edfea]{border-top:#fff;background-color:#fff;margin-bottom:%?20?%;margin-top:%?-10?%;padding-bottom:%?20?%}.border-topB[data-v-461edfea]{border-bottom:#fff}.topC[data-v-461edfea]{margin-top:%?15?%}.top[data-v-461edfea]{margin-top:%?70?%}uni-button[type="primary"][data-v-461edfea]{background-color:#20a4f7}uni-button[disabled][type="primary"][data-v-461edfea]{background-color:#7fc8f5}',""]),e.exports=a},"65bc":function(e,a,t){"use strict";t.r(a);var i=t("8dd2"),s=t("27d7");for(var n in s)"default"!==n&&function(e){t.d(a,e,(function(){return s[e]}))}(n);t("7bed");var o,l=t("f0c5"),c=Object(l["a"])(s["default"],i["b"],i["c"],!1,null,"461edfea",null,!1,i["a"],o);a["default"]=c.exports},"7bed":function(e,a,t){"use strict";var i=t("ea3d"),s=t.n(i);s.a},"8dd2":function(e,a,t){"use strict";var i;t.d(a,"b",(function(){return s})),t.d(a,"c",(function(){return n})),t.d(a,"a",(function(){return i}));var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-uni-view",{staticClass:"page"},[t("v-uni-view",{staticClass:"page__bd topC"},[t("v-uni-view",{staticClass:"weui-cells weui-cells_after-title"},[t("v-uni-view",{staticClass:"weui-cell"},[t("v-uni-view",{staticClass:"weui-cell__bd"},[e._v("日期：")]),t("v-uni-view",{staticClass:"weui-cell__ft"},[e._v(e._s(e.signDetail.executeTimeS))])],1),t("v-uni-view",{staticClass:"weui-cell"},[t("v-uni-view",{staticClass:"weui-cell__bd"},[e._v("当前打卡时间段：")]),t("v-uni-view",{staticClass:"weui-cell__ft"},[e._v(e._s(e.signDetail.startTimeS)+" ~ "+e._s(e.signDetail.endTimeS))])],1)],1),t("v-uni-view",{staticClass:"weui-cells"},[t("v-uni-view",{staticClass:"weui-cell border-topB"},[t("v-uni-view",{staticClass:"weui-cell__bd"},[t("v-uni-textarea",{staticClass:"weui-textarea",staticStyle:{height:"5.8em"},attrs:{placeholder:"点击输入补卡原因..."},on:{input:function(a){arguments[0]=a=e.$handleEvent(a),e.getReason.apply(void 0,arguments)}}})],1)],1)],1),t("v-uni-view",{staticClass:"weui-cell centerBackground "},[t("v-uni-view",{staticClass:"weui-cell__bd"},[t("v-uni-view",{staticClass:"weui-uploader"},[t("v-uni-view",{staticClass:"weui-uploader__hd"},[t("v-uni-view",{staticClass:"weui-uploader__title"},[e._v("拍照上传（选填）")])],1),t("v-uni-view",{staticClass:"weui-uploader__bd"},[t("v-uni-view",{staticClass:"weui-uploader__files",attrs:{id:"uploaderFiles"}},[e._l(e.files,(function(a,i){return[t("v-uni-view",{key:i+"_0",staticClass:"weui-uploader__file",attrs:{id:a},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.previewImage.apply(void 0,arguments)}}},[t("v-uni-image",{staticClass:"weui-uploader__img",attrs:{src:a,mode:"aspectFill"}})],1)]}))],2),t("v-uni-view",{staticClass:"camera"},[t("v-uni-image",{staticClass:"weui-uploader__img",attrs:{src:e.attendanceImageUrl.camera},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.chooseImage.apply(void 0,arguments)}}})],1)],1)],1)],1)],1),t("v-uni-view",{staticClass:"page__bd topC"},[t("v-uni-view",{staticClass:"weui-cells weui-cells_after-title"},[t("v-uni-view",{staticClass:"weui-cell"},[t("v-uni-view",{staticClass:"weui-cell__bd"},[e._v("接收人")]),t("v-uni-view",{staticClass:"weui-cell__ft"},[e._v(e._s(e.signDetail.teacherName))])],1)],1)],1),t("v-uni-view",{staticClass:"page__bd page__bd_spacing top"},[t("v-uni-button",{staticClass:"weui-btn",attrs:{disabled:e.disabled,type:"primary"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.confirmApply.apply(void 0,arguments)}}},[e._v("提交")])],1)],1)],1)},n=[]},d789:function(e,a,t){"use strict";var i=t("4ea4");t("99af"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var s=i(t("ade3")),n=getApp(),o=t("eae7"),l={data:function(){return{attendanceImageUrl:o,signDetail:{},files:[],imageBase64:[],reasonDetail:"",disabled:!1,isAgainApply:0}},components:{},props:{},onLoad:function(e){console.log("------------------------学生补卡申请------------------------");var a=n.globalData.StorageUtil.get("userInfoCach"),t=e.executePlanId,i=e.isAgainApply;t&&this.getComedyAttendInfo(a,t),i&&(this.setData({isAgainApply:i}),console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>",this.isAgainApply))},methods:{getComedyAttendInfo:function(e,a){var t=this;n.globalData.ShowMsgUtil.netErrNotice(),wx.request({url:n.globalData.RequestUrl.attendanceRequestUrl.getComedyAttendInfo+"?executePlanId="+a,method:"GET",header:{token:e.token,"content-type":"application/json"},success:function(e){if(console.log("查询补签详情并显示返回",e.data),e.data&&200==e.data.code){var a=e.data.rows;a.startTimeS=n.globalData.PublicUtil.formatTimeTwo(a.startTime,"h:m"),a.endTimeS=n.globalData.PublicUtil.formatTimeTwo(a.endTime,"h:m"),a.executeTimeS=n.globalData.PublicUtil.formatTimeTwo(a.executeTime,"Y-M-D"),t.setData({signDetail:a})}else n.globalData.ShowMsgUtil.showErrorModal("请求失败",e.data.msg,e.data.code)},fail:function(){n.globalData.ShowMsgUtil.showNoneToastByFail()}})},confirmApply:function(){var e=this;n.globalData.ShowMsgUtil.netErrNotice();var a=this.signDetail,t=(new Date).getTime(),i=n.globalData.StorageUtil.get("userInfoCach");e.setData({disabled:!0}),n.globalData.ShowMsgUtil.showLoadToast("正在申请..."),wx.request({url:n.globalData.RequestUrl.attendanceRequestUrl.applyComedySign,data:{planId:a.planId,executePlanId:a.executePlanId,applyTime:t,userId:i.userId,type:30,reason:e.reasonDetail,files:e.imageBase64,isAgainApply:this.isAgainApply},method:"POST",header:{token:i.token,"content-type":"application/json"},success:function(a){if(console.log("提交补卡申请返回",a.data),!a.data||200!=a.data.code)return e.setData({disabled:!1}),void n.globalData.ShowMsgUtil.showErrorModal("请求失败",a.data.msg,a.data.code);n.globalData.ShowMsgUtil.showSuccessAndReturn("补卡申请成功",2e3),wx.navigateBack({delta:1})},fail:function(){e.setData({disabled:!1}),n.globalData.ShowMsgUtil.showNoneToastByFail()},complete:function(){wx.hideToast({})}})},chooseImage:function(e){var a,t=this;t.files.length<2?(a="android"==e.platform?["拍摄","从相册中选择","取消"]:["拍摄","从相册中选择"],wx.showActionSheet({itemList:a,success:function(e){"0"==e.tapIndex?t.takeCamera():"1"==e.tapIndex&&t.takePhoto()}})):n.globalData.ShowMsgUtil.showErrorModal("只能传两张！","超过上传图片的个数")},takeCamera:function(e){var a=this;wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(e){var t=e.tempFilePaths[0];a.chageBase64(t),a.setData({files:a.files.concat(e.tempFilePaths)})},fail:function(e){n.globalData.ShowMsgUtil.showErrorModal("请稍后再试","选择图片失败！")}})},takePhoto:function(e){var a=this;wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["album"],success:function(e){var t=e.tempFilePaths[0];a.chageBase64(t),a.setData({files:a.files.concat(e.tempFilePaths)})},fail:function(e){n.globalData.ShowMsgUtil.showErrorModal("请稍后再试","选择图片失败！")}})},previewImage:function(e){wx.previewImage({current:e.currentTarget.id,urls:this.files})},chageBase64:function(e){var a=this;wx.getFileSystemManager().readFile({filePath:e,encoding:"base64",success:function(e){var t=a.imageBase64.length;a.setData((0,s.default)({},"imageBase64["+t+"]",e.data))}})},getReason:function(e){this.setData({reasonDetail:e.detail.value})}}};a.default=l},ea3d:function(e,a,t){var i=t("4bbd");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=t("4f06").default;s("92c9ba84",i,!0,{sourceMap:!1,shadowMode:!1})},eae7:function(e,a){var t="/static/pages/attendanceModule/resources/pic",i={image:t,deletePic:"".concat(t,"/delete.png"),approvalAgree:"".concat(t,"/approval_agree.png"),approvalReject:"".concat(t,"/approval_reject.png"),clock:"".concat(t,"/clock.png"),attendaceStatistics:"".concat(t,"/attendaceStatistics.png"),position:"".concat(t,"/position.png"),error:"".concat(t,"/error.png"),right:"".concat(t,"/right.png"),msg:"".concat(t,"/msg.png"),start:"".concat(t,"/start.png"),end:"".concat(t,"/end.png"),camera:"".concat(t,"/camera.png")};e.exports=i}}]);