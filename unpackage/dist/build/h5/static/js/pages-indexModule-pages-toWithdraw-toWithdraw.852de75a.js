(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-indexModule-pages-toWithdraw-toWithdraw"],{"2fb5":function(t,e,a){"use strict";a.r(e);var i=a("d5e3"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},"3de4":function(t,e,a){"use strict";a("c975"),a("13d5"),a("4d63"),a("ac1f"),a("25f0"),a("466d"),a("5319"),a("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,n=/^<\/([-A-Za-z0-9_]+)[^>]*>/,o=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,s=p("area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr"),r=p("a,address,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),l=p("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),c=p("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),d=p("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),u=p("script,style");function h(t,e){var a,h,p,f=[],b=t;f.last=function(){return this[this.length-1]};while(t){if(h=!0,f.last()&&u[f.last()])t=t.replace(new RegExp("([\\s\\S]*?)</"+f.last()+"[^>]*>"),(function(t,a){return a=a.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),e.chars&&e.chars(a),""})),w("",f.last());else if(0==t.indexOf("\x3c!--")?(a=t.indexOf("--\x3e"),a>=0&&(e.comment&&e.comment(t.substring(4,a)),t=t.substring(a+3),h=!1)):0==t.indexOf("</")?(p=t.match(n),p&&(t=t.substring(p[0].length),p[0].replace(n,w),h=!1)):0==t.indexOf("<")&&(p=t.match(i),p&&(t=t.substring(p[0].length),p[0].replace(i,v),h=!1)),h){a=t.indexOf("<");var g=a<0?t:t.substring(0,a);t=a<0?"":t.substring(a),e.chars&&e.chars(g)}if(t==b)throw"Parse Error: "+t;b=t}function v(t,a,i,n){if(a=a.toLowerCase(),r[a])while(f.last()&&l[f.last()])w("",f.last());if(c[a]&&f.last()==a&&w("",a),n=s[a]||!!n,n||f.push(a),e.start){var u=[];i.replace(o,(function(t,e){var a=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:d[e]?e:"";u.push({name:e,value:a,escaped:a.replace(/(^|[^\\])"/g,'$1\\"')})})),e.start&&e.start(a,u,n)}}function w(t,a){if(a){for(i=f.length-1;i>=0;i--)if(f[i]==a)break}else var i=0;if(i>=0){for(var n=f.length-1;n>=i;n--)e.end&&e.end(f[n]);f.length=i}}w()}function p(t){for(var e={},a=t.split(","),i=0;i<a.length;i++)e[a[i]]=!0;return e}function f(t){return t.replace(/<\?xml.*\?>\n/,"").replace(/<!doctype.*>\n/,"").replace(/<!DOCTYPE.*>\n/,"")}function b(t){return t.reduce((function(t,e){var a=e.value,i=e.name;return t[i]?t[i]=t[i]+" "+a:t[i]=a,t}),{})}function g(t){t=f(t);var e=[],a={node:"root",children:[]};return h(t,{start:function(t,i,n){var o={name:t};if(0!==i.length&&(o.attrs=b(i)),n){var s=e[0]||a;s.children||(s.children=[]),s.children.push(o)}else e.unshift(o)},end:function(t){var i=e.shift();if(i.name!==t&&console.error("invalid state: mismatch end tag"),0===e.length)a.children.push(i);else{var n=e[0];n.children||(n.children=[]),n.children.push(i)}},chars:function(t){var i={type:"text",text:t};if(0===e.length)a.children.push(i);else{var n=e[0];n.children||(n.children=[]),n.children.push(i)}},comment:function(t){var a={node:"comment",text:t},i=e[0];i.children||(i.children=[]),i.children.push(a)}}),a.children}var v=g;e.default=v},"608f":function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"page"},[a("v-uni-view",{staticClass:"page__bd"},[a("v-uni-view",{staticClass:"weui-cells weui-cells_after-title box-top"},[a("v-uni-view",{staticClass:"weui-cell weui-cell_access",attrs:{"hover-class":"weui-cell_active"}},[a("v-uni-view",{staticClass:"weui-cell__bd"},[t._v("退款到")]),t.PickerChange?a("v-uni-view",[a("v-uni-view",{staticClass:"weui-cell__ft weui-cell__ft_in-access"},[t._v(t._s(t.bankCardList[t.cardId]))])],1):a("v-uni-view",[a("v-uni-view",{staticClass:"weui-cell__ft weui-cell__ft_in-access"},[t._v(t._s(t.withdrawMsg))])],1)],1)],1),a("v-uni-view",{staticClass:"weui-cells weui-cells_after-title box-top"},[a("v-uni-view",{staticClass:"center-box"},[a("v-uni-view",{staticClass:"input-title"},[t._v("退款金额")]),a("v-uni-view",{staticClass:"input-box"},[a("v-uni-text",{staticClass:"MonIcon"},[t._v("￥")]),a("v-uni-input",{staticClass:"input-value",attrs:{value:t.inputMoney,type:"digit",maxlength:"6"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.toInputMoney.apply(void 0,arguments)}},model:{value:t.inputMoney,callback:function(e){t.inputMoney=e},expression:"inputMoney"}})],1)],1),t.errNotice?a("v-uni-view",{staticClass:"weui-cell errNotices"},[a("v-uni-text",{staticClass:"errNotice"},[t._v(t._s(t.errNotice))])],1):t._e(),a("v-uni-view",{staticClass:"weui-cell weui-cell_access",attrs:{"hover-class":"weui-cell_active"}},[a("v-uni-view",{staticClass:"weui-cell__bd"},[t._v("可用余额 "+t._s(t.balance)+" 元")]),a("v-uni-view",{staticClass:"weui-cell__ft toWithdraw-font",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toAllWithdraw.apply(void 0,arguments)}}},[t._v("全部退款")])],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.showphone,expression:"showphone"}],staticClass:"input-group"},[a("v-uni-text",{staticClass:"input-label"},[t._v("手机号：")]),a("v-uni-input",{attrs:{type:"number",name:"phone",placeholder:"请输入手机号",maxlength:"20","cursor-spacing":"20",value:""},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.phoneInput.apply(void 0,arguments)}}})],1),t.minder?a("v-uni-view",{staticClass:"reminder"},[a("span",[t._v("请输入整数不包含小数")])]):t._e()],1),a("v-uni-view",{staticClass:"weui-cell errNotices"},[a("p",[t._v("为了保障财产安全，目前只允许提现至本人的支付宝账号，\n                请确保输入的手机号码为本人的支付宝账号绑定的手机号码")])]),a("v-uni-view",{staticClass:"page__bd page__bd_spacing bottom"},[a("v-uni-button",{staticClass:"weui-btn btn-font",attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toWithdraw.apply(void 0,arguments)}}},[t._v("确认退款")])],1)],1)],1)},o=[]},"8bb4":function(t,e,a){"use strict";var i=a("c46e"),n=a.n(i);n.a},"9e9d":function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,'.top[data-v-391e98f6]{margin-top:%?15?%}.box-top[data-v-391e98f6]{margin-top:%?40?%}.bottom[data-v-391e98f6]{margin-top:%?160?%}uni-button[type="primary"][data-v-391e98f6]{color:#fff;background-color:#20a4f7}uni-button[disabled][type="primary"][data-v-391e98f6]{background-color:#7fc8f5}.bottom-top[data-v-391e98f6]{margin-top:%?140?%}.center-box[data-v-391e98f6]{width:100%;height:%?260?%\r\n  /* padding-top: 20rpx; */}.input-title[data-v-391e98f6]{width:100%;height:%?100?%;margin-left:%?40?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.input-box[data-v-391e98f6]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin-left:%?20?%;font-size:48px;width:100%;height:%?150?%}.input-value[data-v-391e98f6]{width:100%;height:%?120?%;font-size:%?70?%!important}.toWithdraw-font[data-v-391e98f6]{color:#20a4f7}.MonIcon[data-v-391e98f6]{font-size:%?28?%}.errNotice[data-v-391e98f6]{color:#888}.errNotices[data-v-391e98f6]{font-size:15px}.whetherclick[data-v-391e98f6]{margin-top:%?15?%;margin-left:10px;font-size:14px}.c-top[data-v-391e98f6]{margin-left:20px}.items-select-pic[data-v-391e98f6]{width:30px;height:30ox}.input-group[data-v-391e98f6]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:10px 15px}.reminder[data-v-391e98f6]{padding:10px 15px}',""]),t.exports=e},c46e:function(t,e,a){var i=a("9e9d");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("abf95654",i,!0,{sourceMap:!1,shadowMode:!1})},d5e3:function(t,e,a){"use strict";a("acd8"),a("4d63"),a("ac1f"),a("25f0"),a("466d"),a("5319"),a("841c"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i="",n=getApp(),o=a("27cd"),s=(a("3de4"),{data:function(){return{listIotBankData:[],bankCardList:[],listIotBankCard:[],withdrawMsg:"支付宝",balance:"",inputMoney:"",cardId:"",selectCardNumber:"",disabled:!0,phonevalue:"",errNotice:"",PickerChange:!1,chargeType:-1,showphone:!1,phoneNum:"",inputmoney:"",minder:!1,pageObj:{balance:0,integral:0,btnList:[]}}},components:{},props:{},onLoad:function(t){console.log("------------------------退款------------------------"),console.log(t),this.getDeductionModel(),9==t.chargeType?uni.setNavigationBarTitle({title:"热水费提现"}):6==t.chargeType&&uni.setNavigationBarTitle({title:"余额提现"});var e=n.globalData.StorageUtil.get("userInfoCach");this.requestQueryBankCardList(e)},onShow:function(){this.getDeductionModel()},methods:{authorize:function(){if(alert(location.href),i=this.getQueryString("auth_code"),""==i||""===i){var t=encodeURIComponent("kyzh://kyzhiot:8888/home?"+location.href),e="2018121862586361",a="auth_userinfo",n="https://openauth.alipay.com/oauth2/publicAppAuthorize.htm?app_id="+e+"&scope="+a+"&redirect_uri="+t,o="alipays://platformapi/startapp?appId=20000067&url="+encodeURIComponent(n);location.href=o}else alert(i),this.getOpenId(i)},getQueryString:function(t){console.log(t);var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(e);return null!=a&&unescape(a[2])},getOpenId:function(t){wx.request({url:n.globalData.RequestUrl.payRequestUrl.AliPayGetOpenID,data:{code:t},method:"POST",header:{token:userInfoCach.token},success:function(t){console.log(t),console.log("请求openId-",t.data),t.data&&200===t.data.code?this.requestToWithdraw(userInfoCach):n.globalData.ShowMsgUtil.showErrorModal("授权失败",t.data.msg,t.data.code)},fail:function(){n.globalData.ShowMsgUtil.showNoneToastByFail()}})},toAllWithdraw:function(){this.setData({inputMoney:this.balance}),this.balance.length>0&&(this.showphone=!0)},checkPhone:function(t){var e=/^1\d{10}$/;return!!e.test(t)},phoneInput:function(t){var e=this;e.phonevalue=t.detail.value;var a=parseFloat(this.balance);e.phonevalue.length>0&&a>=this.inputmoney?this.setData({disabled:!1}):this.setData({disabled:!0});t.detail.value},toInputMoney:function(t){var e=this,a=t.detail.value,i=/^[1-9]{1}[0-9]*$/;this.inputmoney=a,a.length>0?this.showphone=!0:this.showphone=!1;i=/^(([1-9]{1}\d*)|(0{1}))(\.\d{2})$/;i.test(a)?this.inputMoney=t:setTimeout((function(){e.inputMoney=a.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")}),0),this.setData({inputMoney:t.detail.value});var n=parseFloat(this.balance);if(this.inputmoney=a,a>n)return this.errNotice="请输入可提现余额",void this.setData({disabled:!0});this.errNotice=""},toWithdraw:function(){var t=n.globalData.StorageUtil.get("userInfoCach"),e=this;if(e.setData({disabled:!0}),1!=t.isMortal)return e.checkPhone(e.phonevalue)?void this.requestToWithdraw(t):(n.globalData.ShowMsgUtil.showErrorModal("格式不正确","请输入正确的手机号！"),void this.setData({disabled:!0}));n.globalData.ShowMsgUtil.showErrorModal("提醒","培训人员暂不支持该功能！")},getDeductionModel:function(){var t=this;n.globalData.ShowMsgUtil.netErrNotice();var e=n.globalData.StorageUtil.get("userInfoCach");wx.request({url:n.globalData.RequestUrl.baseRequestUrl.getDeductionModel,method:"GET",header:{token:e.token},success:function(a){a.data&&200==a.data.code?t.queryBalance(e,a.data.rows.deductionModel):n.globalData.ShowMsgUtil.showErrorModal("请求失败",a.data.msg,a.data.code)},fail:function(){n.globalData.ShowMsgUtil.showNoneToastByFail()}})},queryBalance:function(t,e){var a=this;n.globalData.ShowMsgUtil.netErrNotice(),wx.request({url:n.globalData.RequestUrl.baseRequestUrl.balance,method:"POST",header:{token:t.token},data:{deductionMode:e},success:function(t){t.data&&200==t.data.code?(n.globalData.StorageUtil.set("purseBalanceCach",t.data.rows.purseBalance),a.balance=n.globalData.PublicUtil.minuteChanageYuanBalance(t.data.rows.purseBalance.balance)):n.globalData.ShowMsgUtil.showErrorModal("请求失败",t.data.msg,t.data.code)},fail:function(){n.globalData.ShowMsgUtil.showNoneToastByFail()}})},requestToWithdraw:function(t){var e=this,a=100*e.inputMoney,i=n.globalData.CryptoJS.EncryptBASE64(a);n.globalData.ShowMsgUtil.netErrNotice(),wx.request({url:n.globalData.RequestUrl.baseRequestUrl.payRefund,data:{money:i,openId:e.phonevalue,chargeType:6},method:"POST",header:{token:t.token,"content-type":"application/json"},success:function(t){console.log("退款申请后返回",t.data),!t.data||200!=t.data.code&&0!=t.data.code?n.globalData.ShowMsgUtil.showErrorModal("请求失败",t.data.msg,t.data.code):wx.showModal({title:"提现申请",content:t.data.msg,showCancel:!1,cancelText:"否",confirmText:"确定",confirmColor:"skyblue",success:function(t){t.cancel||n.globalData.PublicUtil.navigateByUrl(n.globalData.PageUrl.indexPageUrl.walletIndexUrl,500)}})},fail:function(){n.globalData.ShowMsgUtil.showNoneToastByFail()}})},requestQueryBankCardList:function(t){var e=this;n.globalData.ShowMsgUtil.netErrNotice(),wx.request({url:n.globalData.RequestUrl.baseRequestUrl.listIotBankCard,header:{token:t.token,"content-type":"application/json"},method:"POST",success:function(t){t.data&&200==t.data.code?(1==t.data.rows.refundSwitch&&e.setData({amount:!0,listIoBankData:t.data.rows.refundTime}),e.listIotBankData=t.data.rows,t.data.rows.bankCardList.length>0?(e.setData({listIotBankCard:t.data.rows.bankCardList,withdrawMsg:"支付宝"}),e.showBankInfo(t.data.rows.bankCardList)):e.setData({withdrawMsg:"支付宝"})):n.globalData.ShowMsgUtil.showErrorModal("请求失败",t.data.msg,t.data.code)},fail:function(){n.globalData.ShowMsgUtil.showNoneToastByFail()}})},showBankInfo:function(t){for(var e=[],a=0;a<t.length;++a){var i="",n=o.bankCardAttribution(t[a].cardNumber);i="error"===n?"未知（"+this.bankCard(t[a].cardNumber)+"）":n.bankName+"（"+this.bankCard(t[a].cardNumber)+"）",e[a]=i}this.setData({bankCardList:e})},bankCard:function(t){var e=t.substring(t.length-4,t.length);return e}}});e.default=s},f150:function(t,e,a){"use strict";a.r(e);var i=a("608f"),n=a("2fb5");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("8bb4");var s,r=a("f0c5"),l=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"391e98f6",null,!1,i["a"],s);e["default"]=l.exports}}]);