(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-mineModule-pages-setLimit-setLimit"],{"10b5":function(t,e,a){"use strict";var i=a("a8ea"),o=a.n(i);o.a},"1dd4":function(t,e,a){"use strict";a.r(e);var i=a("a8e5"),o=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=o.a},"497e":function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"page page_view"},[a("v-uni-view",{staticClass:"page__bd"},t._l(t.setList,(function(e,i){return a("v-uni-view",{key:i,staticClass:"title__bd",attrs:{item:e}},[a("v-uni-view",{staticClass:"weui-cells__title title_font"},[t._v(t._s(e.title)+"（"),a("v-uni-text",{staticClass:"title_font_min"},[t._v(t._s(e.msg))]),t._v("）")],1),a("v-uni-view",{staticClass:"weui-cells weui-cells_after-title"},[a("v-uni-view",{staticClass:"weui-cell weui-cell_input"},[a("v-uni-view",{staticClass:"weui-cell__bd"},[a("v-uni-input",{staticClass:"weui-input",attrs:{type:"number",value:"",placeholder:e.placeholderName},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.inputTap(e,i)}}})],1)],1)],1)],1)})),1),a("v-uni-view",{staticClass:"page__bd"},[a("v-uni-view",{staticClass:"page__bd page__bd_spacing title__bd"},[a("v-uni-button",{staticClass:"weui-btn page_submit",attrs:{disabled:t.disabled},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.confirmLimit.apply(void 0,arguments)}}},[t._v("确认办理")])],1)],1),a("v-uni-view",{staticClass:"page__bd"},[a("v-uni-view",{staticClass:"page__bd page__bd_spacing"},[a("v-uni-button",{staticClass:"weui-btn page_submit submit_a",attrs:{disabled:t.canceldisabled,type:"default"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clearLimit.apply(void 0,arguments)}}},[t._v("取消限额")])],1)],1),a("v-uni-view",{staticClass:"page__bd setLimit-view"},[a("v-uni-view",{staticClass:"weui-article"},[a("v-uni-view",{staticClass:"weui-article__h1 h1-font"},[t._v("温馨提示")]),a("v-uni-view",{staticClass:"weui-article__section"},[a("v-uni-view",{staticClass:"weui-media-box__desc desc-font"},[t._v("1. 取消限额按钮为取消全部的限额设置。")]),a("v-uni-view",{staticClass:"weui-media-box__desc desc-font"},[t._v("2. 设置单笔交易限额后，单笔消费不能超过该限额。")]),a("v-uni-view",{staticClass:"weui-media-box__desc desc-font"},[t._v("3. 设置单日累计交易限额后，每日累计消费不能超出该限制。")]),a("v-uni-view",{staticClass:"weui-media-box__desc desc-font"},[t._v("4. 设置单月累计交易限额后，每月累计消费不能超出该限制。")]),a("v-uni-view",{staticClass:"weui-media-box__desc desc-font"},[t._v("5. 该设置限制所有交易类型，如卡片消费，二维码消费。")])],1)],1)],1)],1)},n=[]},9839:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,"\r\n/* pages/more/set_limit.wxss */.title__bd[data-v-189df26e]{padding-top:%?15?%}\r\n\r\n/* .title_font{\r\n  font-size: 17px;\r\n} */.title_font_min[data-v-189df26e]{\r\n  /* font-size: 14px; */color:#20a4f7}.setLimit-view[data-v-189df26e]{margin-top:%?50?%}.h1-font[data-v-189df26e]{color:#999}.desc-font[data-v-189df26e]{margin-top:%?10?%}.submit_a[data-v-189df26e]{border:1px solid #e5e5e5}",""]),t.exports=e},a8e5:function(t,e,a){"use strict";var i=a("4ea4");a("e25e"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(a("ade3")),n=getApp(),s={data:function(){return{setList:[{id:1,title:"单笔交易限额",placeholderName:"请输入单笔交易限额（选填）",msg:"未设置",val:"onceLimit"},{id:2,title:"单日累计交易限额",placeholderName:"请输入单日交易限额（选填）",msg:"未设置",val:"oneDayLimit"},{id:3,title:"单月累计交易限额",placeholderName:"请输入单月交易限额（选填）",msg:"未设置",val:"oneMonthLimit"}],userInfoCach:{},onceLimit:"",oneDayLimit:"",oneMonthLimit:"",inputValue:"",disabled:!1,canceldisabled:!1,msg:""}},onLoad:function(t){console.log("------------------------设置限额------------------------");var e=this,a=n.globalData.StorageUtil.get("userInfoCach");e.setData({userInfoCach:a}),n.globalData.StorageUtil.get("onceLimitCach")||n.globalData.StorageUtil.get("oneDayLimitCach")||n.globalData.StorageUtil.get("oneMonthLimitCach")?(e.setValue(0,n.globalData.StorageUtil.get("onceLimitCach")),e.setValue(1,n.globalData.StorageUtil.get("oneDayLimitCach")),e.setValue(2,n.globalData.StorageUtil.get("oneMonthLimitCach")),wx.hideToast()):this.getSetVal()},methods:{getSetVal:function(){var t=this;n.globalData.ShowMsgUtil.netErrNotice();var e=n.globalData.StorageUtil.get("userInfoCach");uni.request({url:n.globalData.RequestUrl.baseRequestUrl.getLimitMoney,header:{token:e.token},method:"GET",success:function(e){console.log("限额设置",e.data.rows),e.data&&200==e.data.code?(t.setValue(0,e.data.rows.onceLimit),t.setValue(1,e.data.rows.oneDayLimit),t.setValue(2,e.data.rows.oneMonthLimit)):(n.globalData.ShowMsgUtil.showErrorModal("加载失败",e.data.msg,e.data.code),t.setData({msg:"加载失败，请稍后再试"}))},fail:function(){n.globalData.ShowMsgUtil.showNoneToastByFail()}})},showNetError:function(){n.globalData.showNetWorkError("网络异常"),setTimeout((function(){wx.hideNavigationBarLoading()}),5e3)},setValue:function(t,e){var a=this;null!=e&&""!=e?a.setOneMsg(t,e):a.setMsg(t)},setOneMsg:function(t,e){var a="当前限额￥";this.setData((0,o.default)({},"setList["+t+"].msg",a+e))},setMsg:function(t){var e="未设置";this.setData((0,o.default)({},"setList["+t+"].msg",e))},inputTap:function(t,e){console.log(t,e);var a=parseInt(t.detail.value);0==e?this.setData({onceLimit:a}):1==e?this.setData({oneDayLimit:a}):2==e&&this.setData({oneMonthLimit:a})},verify:function(t){if(0!=t.length)return Math.floor(t)===t},confirmLimit:function(t){var e=this,a=e.onceLimit,i=e.oneDayLimit,o=e.oneMonthLimit;wx.showModal({title:"提示",content:"是否确认限额？",confirmColor:"#20a4f7",success:function(t){if(t.confirm){if(0==a.length&&0==i.length&&0==o.length)return void n.globalData.ShowMsgUtil.showErrorModal("请先重新设置！","你没有设置新的金额");e.verify(a)||e.verify(i)||e.verify(o)?0==a.length&&0==i.length&&0==o.length||e.confirmSetLimit():n.globalData.ShowMsgUtil.showErrorModal("请重新输入！","你设置的金额不是正整数")}else t.cancel},fail:function(t){n.globalData.ShowMsgUtil.showNoneToastByFail()}})},confirmSetLimit:function(t){var e=this;n.globalData.ShowMsgUtil.netErrNotice();this.disabled;e.setData({disabled:!0}),uni.request({url:n.globalData.RequestUrl.baseRequestUrl.limitMoney,data:{onceLimit:e.onceLimit,oneDayLimit:e.oneDayLimit,oneMonthLimit:e.oneMonthLimit},header:{token:e.userInfoCach.token,"content-type":"application/json"},method:"PUT",success:function(t){if(console.log("限额设置返回",t),!t.data||200!=t.data.code)return e.setData({disabled:!1}),void n.globalData.ShowMsgUtil.showErrorModal("请求失败",t.data.msg,t.data.code);n.globalData.ShowMsgUtil.showSuccessToast("限额设置成功！",2e3),e.onceLimit&&n.globalData.StorageUtil.set("onceLimitCach",e.onceLimit),e.oneDayLimit&&n.globalData.StorageUtil.set("oneDayLimitCach",e.oneDayLimit),e.oneMonthLimit&&n.globalData.StorageUtil.set("oneMonthLimitCach",e.oneMonthLimit),e.setData({disabled:!1}),e.clearPage()},fail:function(){e.setData({disabled:!1}),n.globalData.ShowMsgUtil.showNoneToastByFail(),e.showNetError()}})},clearPage:function(t){console.log("刷新页面");window.location.reload()},clearLimit:function(t){var e=this;e.onceLimit,e.oneDayLimit,e.oneMonthLimit;wx.showModal({title:"提示",content:"是否取消全部限额？",confirmColor:"#20a4f7",success:function(t){t.confirm?e.deleteSetLimit():t.cancel&&console.log("是否取消全部限额？","用户点击取消")}})},deleteSetLimit:function(t){var e=this;n.globalData.ShowMsgUtil.netErrNotice();this.canceldisabled;e.setData({canceldisabled:!0}),wx.request({url:n.globalData.RequestUrl.baseRequestUrl.deleteLimitMoney,method:"POST",header:{token:e.userInfoCach.token},success:function(t){t.data&&200==t.data.code?(n.globalData.ShowMsgUtil.showSuccessToast("删除设置成功！",2e3),n.globalData.StorageUtil.remove("onceLimitCach"),n.globalData.StorageUtil.remove("oneDayLimitCach"),n.globalData.StorageUtil.remove("oneMonthLimitCach"),e.clearPage()):n.globalData.ShowMsgUtil.showErrorModal("删除失败！",t.data.msg,t.data.code),e.setData({canceldisabled:!1})},fail:function(){e.setData({canceldisabled:!1}),n.globalData.ShowMsgUtil.showNoneToastByFail(),e.showNetError()}})}}};e.default=s},a8ea:function(t,e,a){var i=a("9839");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=a("4f06").default;o("0f3c709e",i,!0,{sourceMap:!1,shadowMode:!1})},dd58:function(t,e,a){"use strict";a.r(e);var i=a("497e"),o=a("1dd4");for(var n in o)"default"!==n&&function(t){a.d(e,t,(function(){return o[t]}))}(n);a("10b5");var s,l=a("f0c5"),c=Object(l["a"])(o["default"],i["b"],i["c"],!1,null,"189df26e",null,!1,i["a"],s);e["default"]=c.exports}}]);